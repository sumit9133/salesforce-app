<apex:page sidebar="false" controller="Bread_Winner.BreadwinnerController" tabStyle="Breadwinner__tab" action="{!initializeApp}" title="Breadwinner">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        
        <head>
            <apex:stylesheet value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/styles/salesforce-lightning-design-system-vf.min.css')}" ></apex:stylesheet>
            <apex:includeScript value="{!URLFOR($Resource.Bread_Winner__Breadwinner_jQuery, 'jquery.min.js')}" />
            <script type="text/javascript">
            var __sfdcSessionId = '{!GETSESSIONID()}';
            </script>
            <script type="text/javascript">
            var clicky_custom = clicky_custom || {};
            clicky_custom.href = '/breadwinner-app/',
                clicky_custom.title = 'Breadwinner App for {!$Organization.Id}',
                clicky_custom.timer = 500;
            clicky_custom.timeout = 10;
            clicky_custom.cookies_disable = 0;
            clicky_custom.queue_disable = 0;
            clicky_custom.sticky_data_disable = 0;
            clicky_custom.outbound_disable = 1;
            clicky_custom.video_disable = 1;
            clicky_custom.history_disable = 0;
            clicky_custom.ping_disable = 1;
            clicky_custom.pageview_disable = 0;
            clicky_custom.osa_disable = 1;
            clicky_custom.heatmap_disable = 1;
            clicky_custom.visitor = {
                lmo: "true",
                org_id: "{!$Organization.Id}",
                DaddyAnalytics: (new Date()).getTime() + "-" +(Math.floor(Math.random() * (9999999 - 1000000) )+ 1000000)
            };
            </script>
            <script src="//hello.staticstuff.net/w/__stats.js" type="text/javascript"></script>
            <script type="text/javascript">
                try{
                    if({!NOT(isConsumerDetailFilled)}){
                        clicky.init(100547279);
                        console.log('sent');
                    } 
                }
            catch(e){console.log(e);}
            </script>

            <script>
            
            var j$ = jQuery.noConflict();
            
            function selectTab(elmnt) {
                j$("#Breadwinner-Left-Menu ul").children(".slds-is-active").removeClass("slds-is-active");
                j$(elmnt).parent("li").addClass("slds-is-active");
                
                j$("#breadwinner-right-content div.slds-show").addClass("slds-hide");
                j$("#breadwinner-right-content div.slds-show").removeClass("slds-show");
                
                j$("#breadwinner-right-content").children("div[aria-labelledby='"+elmnt.id+"']").addClass("slds-show");
                
            }
            
            function showHideNestedMenu(elmnt){
                
                if(j$(elmnt).parent("li").hasClass("slds-section slds-is-open")){
                    j$(elmnt).parent("li").removeClass("slds-section slds-is-open");
                    j$(elmnt).parent("li").children("ul.slds-is-nested.slds-show").removeClass("slds-show").addClass("slds-hide");
                }
                else{
                    j$(elmnt).parent("li").addClass("slds-section slds-is-open");
                    j$(elmnt).parent("li").children("ul.slds-is-nested").removeClass("slds-hide").addClass("slds-show");
                }
               
            }
            
            function HandleSearch(){
                var findword=j$("#MenuSearchBox").val().toLowerCase();
                j$( "#Breadwinner-Left-Menu ul li" ).addClass("slds-hide").removeClass("slds-show");
                
                var checkOpenedInnerTab=j$("li.slds-list__item.slds-is-active").length;
                console.log('inner count:'+checkOpenedInnerTab);
                if(findword.length > 0){
                    
                    j$( "h2.slds-text-title--caps" ).css( "display", "none" );
                    
                    j$( "#Breadwinner-Left-Menu ul li.searachableclass a" ).each(function( index ) {
                        var textreturned=j$( this ).text().toLowerCase()

                        if(textreturned.indexOf(findword)>-1){
                            
                            j$( this ).parents("li,ul").removeClass("slds-hide").addClass("slds-show");
                            j$( this ).parents("li.nestedcheck").addClass("slds-section slds-is-open");
                        }
                        
                    });
                    
                }
                else{
                    j$( "#Breadwinner-Left-Menu ul li" ).removeClass("slds-hide").addClass("slds-show");
                    j$("#Breadwinner-Left-Menu").find("li.slds-section.slds-is-open ul").removeClass("slds-show").addClass("slds-hide");
                    j$("#Breadwinner-Left-Menu").find("li.slds-section.slds-is-open").removeClass("slds-section slds-is-open");
                    
                    if(checkOpenedInnerTab>0){
                        j$("#Breadwinner-Left-Menu li.slds-list__item.slds-is-active").parents("li.nestedcheck").addClass("slds-section slds-is-open");
                        j$("#Breadwinner-Left-Menu li.slds-list__item.slds-is-active").parents("ul").removeClass("slds-hide").addClass("slds-show");
                    }                    
                    j$( "h2.slds-text-title--caps" ).css( "display", "initial" );
                }
                
            }
            
            function  OpenContactSupportTab(){
                var SupportTabId="ContactSupport";
                selectTab(document.getElementById(SupportTabId)); 
            }
            
            function  OpenTroubleshootTab(){
                var TroubleshootTab="Troubleshooting";
                selectTab(document.getElementById(TroubleshootTab));
            }
            
            function HideStyleSheet() {
                j$("link.user[href$='elements.css']").each(function() {
                    j$(this).attr("href", "#");
                });
            }
            
            function message() {
                j$(".infoM6, .infoM4, .infoM3, .infoM2, .infoS1").addClass("slds-notify slds-notify--alert slds-theme--inverse-text  slds-text-align--left slds-text-heading--small slds-m-bottom--small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px"} );
                j$(".errorM6, .errorM4, .errorM3, .errorM2, .errorS1").addClass("slds-notify slds-notify--alert slds-theme--error  slds-text-align--left slds-text-heading--small slds-m-bottom--small").css({"font-weight":"500","line-height":"1.4","word-spacing":"1px"});
                j$(".warningM6, .warningM4, .warningM3, .warningM2, .warningS1").addClass("slds-notify slds-notify--alert slds-theme--warning  slds-text-align--left slds-text-heading--small slds-m-bottom--small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px"} ) ;
                j$(".confirmM6, .confirmM4, .confirmM3, .confirmM2, .confirmS1").addClass("slds-notify slds-notify--alert slds-theme--success slds-text-align--left slds-text-heading--small slds-m-bottom--small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px"} ) ;
                
                j$("div .messageText h4").css( "color", "white" );
                j$("div[class*='warning'] div.messageText h4").css( "color", "black" );
                j$("table.messageTable td").css({"color" : "white"});
                j$("div[class*='warning'] table.messageTable td").css( "color", "black" );
            }
           
            function SubTabsSelect(elmnt, XeroOrgId,BillOrPOParam) {
                // slds-active
                j$(elmnt).parent("li").siblings(".slds-active").removeClass("slds-active");
                j$(elmnt).parent("li").addClass("slds-active");
                
                // tabindex
                j$(elmnt).parent("li").siblings().children("a").attr("tabindex", -1);
                j$(elmnt).attr("tabindex", 0);
                
                // aria-selected
                j$(elmnt).parent("li").siblings().children("a").attr("aria-selected", false);
                j$(elmnt).attr("aria-selected", true);
                
                if(BillOrPOParam=='Bill'){
                    BillPassXeroOrgId(XeroOrgId);
                }
                else{
                    PoPassXeroOrgId(XeroOrgId);
                }
                
            }
            
            function identifyfield(elementt, helptext, TopMinusparam,LeftMinusParam) {
                if(j$(".bPageHeader").outerHeight(true)==null){
                    LeftMinusParam=LeftMinusParam-9;
                    TopMinusparam=TopMinusparam-100;
                }
                var x = j$(elementt).offset();
                //alert("Top position: " + x.top + " Left position: " + x.left+" height: "+$(elementt).height());                
                var ToSetleft = x.left - LeftMinusParam;
                j$("#help p").text(helptext);
                var ToSetheight = x.top - TopMinusparam;
                var heptextdiv = document.getElementById("help");
                j$(heptextdiv).css({
                    top: ToSetheight + 'px',
                    left: ToSetleft + 'px',
                    display: ""
                })
                
            }
            
            function mouseoutclose() {
                var heptextdiv = document.getElementById("help");
                j$(heptextdiv).css({
                    top: "0px",
                    left: "0px",
                    display: "none"
                });
            }
            function scrolltoBottom()
            {
                window.scrollTo(0,document.body.scrollHeight);
            }
            
            function scrolltoTop()
            {
                window.scrollTo(0,0);
            }
            
            j$(function() {
                console.log('script loaded');
                HideStyleSheet();
                message();
                createRemoteSiteMetadata();
                onTabEnterPushToInteractionLog('Setup');
                
            });
            function loadIframesfun(iframeSectionId,iframeURL){
        
                // to clear div before we insert iframe
                j$("#"+iframeSectionId).empty();
                
                // to create iframe element
                var para = document.createElement("iframe");
                para.setAttribute("src", iframeURL);
                para.setAttribute("height","800px");
                para.setAttribute("width","100%");
                
                // injecting iframe to refereced div
                document.getElementById(iframeSectionId).appendChild(para);
            }
            
            </script>
            
            <apex:includeScript value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/JS/jsapi.js')}" />
            
            <style>
                
                .message {
                background-color: inherit;
                border-style: none;
                padding: initial;
                }
                table.messageTable td {
                border-top: 0px !important;
                }
                .msgIcon{
                display:none;
                }
                .message .messageText {
                margin: 0px;
                }
                .message .messageText h4 {
                font-weight: inherit;
                display: initial;
                }
                
                .BreadwinnerLightning .slds-table .messageTable td {
                padding: 1px;
                }
                iframe{ border:0px;}
            </style>
            <style>
                .progress-bar {
                background-color: aliceblue;
                height: 25px;
                padding: 3px;
                width: 80%;
                margin: 5px ;         
                border-radius: 5px;
                box-shadow: 0 1px 5px #000 inset, 0 1px 0 #444;           
                }
                
                .progress-bar span {
                background-color: dodgerblue;   
                display: inline-block;
                height: 100%;
                border-radius: 3px;
                box-shadow: 0 1px 0 rgba(255, 255, 255, .5) inset;
                transition: width .4s ease-in-out;    
                }
                
                .BreadwinnerLightning a{
                text-decoration: underline;
                color: gray;
                }
                .BreadwinnerLightning .slds-table td{
                white-space: normal;
                }
                .slds-table td img {
                max-width: initial;
                height:initial;
                }
                .BreadwinnerLightning .slds-spinner_container{
                position: fixed;
                z-index: 9999;
                }
                table.google-visualization-table-table td:nth-child(4) {
                       word-break: break-all;
                   }
               table.google-visualization-table-table td:nth-child(5) {
                       white-space: nowrap;
               }
            </style>
        </head>
        <body>
            <apex:form id="theForm" >
                <div class="BreadwinnerLightning">
                    <!-- ----------------------------------- fields level help ---------------------------------- -->
                    <div id="help" class="slds-popover slds-popover--tooltip slds-nubbin--bottom-left" role="tooltip" aria-live="polite" style="display:none;position:absolute;top:0px;left:0px;">
                        <div class="slds-popover__body slds-text-longform">
                            <p>Help text will come here dynamically</p>
                        </div>
                    </div>
                    <!-- ----------------------------------- fields level help ---------------------------------- -->
                    <apex:pageMessages id="pgmsgtag"></apex:pageMessages>
                    <apex:actionStatus id="assign-action-status" layout="block">
                        <apex:facet name="start">
                            <div class="slds-spinner_container">
                                <div class="slds-spinner--brand slds-spinner slds-spinner--medium" role="alert">
                                    <span class="slds-assistive-text">Loading</span>
                                    <div class="slds-spinner__dot-a"></div>
                                    <div class="slds-spinner__dot-b"></div>
                                </div>
                            </div>
                        </apex:facet>
                    </apex:actionStatus>
                    <apex:actionFunction name="queryappconfigdynamic" action="{!QueryAppconfigDynamic}" status="assign-action-status" reRender="Invoiceconfigsection,BillsMenuFieldsSectionId,PoMenuFieldsSectionId,BatchInvoiceSection" oncomplete="HideStyleSheet();message();">
                        <apex:param name="BillsORPoParam" value="" assignTo="{!BillsORPo}"/>
                    </apex:actionFunction>
                    <apex:outputPanel rendered="{!isBreadwinnerConnection}">
                        <div class="slds-grid slds-wrap">
                            <div class="slds-p-horizontal--x-small slds-size--1-of-1 slds-medium-size--1-of-6 slds-large-size--2-of-12" style="border-right: 1px solid gray;" >
                                <div class="slds-m-top--medium" >
                                    <img src="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/Images/BreadwinnerLogo.png')}" alt="Breadwinner Logo" />
                                </div>
                                
                                <!-- <div class="slds-form-element slds-m-bottom--medium slds-m-top--medium">
                                    <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon--left">
                                        <svg aria-hidden="true" class="slds-input__icon slds-icon-text-default">
                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/utility-sprite/svg/symbols.svg#search')}"></use>
                                        </svg>
                                        <input id="MenuSearchBox" class="slds-input" onkeyup="HandleSearch();" type="text" placeholder="Quick Find" autocomplete="off" />
                                    </div>
                                </div> --><hr style="margin: 0rem;border-top: 1px solid gray;"/>
                                <div id="Breadwinner-Left-Menu" class="slds-grid slds-grid--vertical slds-navigation-list--vertical">
                                    
                                    <h2 class="slds-text-title--caps slds-p-around--medium" id="SETUPANDCONFIG">SETUP AND CONFIG</h2>
                                    <apex:outputPanel >
                                        <ul>
                                            <li class="searachableclass slds-is-active"><a href="javascript:void(0);" onclick="selectTab(this);checkSetupTabStepsCompletedFunc(); onTabEnterPushToInteractionLog('Setup'); " class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="Setup"  title="Setup" >Setup</a></li>
                                        </ul>
                                    </apex:outputPanel>
                                    
                                    <apex:outputPanel rendered="{!AND(!isBusinessOrHigher,listAppConfig.size>0, isAdministrator)}">
                                        <ul>
                                            <!-- <li class="searachableclass slds-is-active"><a href="javascript:void(0);" onclick="selectTab(this);checkSetupTabStepsCompletedFunc(); onTabEnterPushToInteractionLog('Setup'); " class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="Setup"  title="Setup" >Setup</a></li> -->
                                            <li class="searachableclass "><a href="javascript:void(0);" onclick="loadIframesfun('SetupAndConfig-TAB2','{!$Page.BreadwinnerOptionalSettings}');queryappconfigdynamic('BillPO');selectTab(this);onTabEnterPushToInteractionLog('Invoice Configuration');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="InvoiceContent" title="Invoice Configuration" >Invoice Configuration</a></li>
                                        </ul>
                                    </apex:outputPanel>
                                    <apex:outputPanel rendered="{!AND(isBusinessOrHigher,listAppConfig.size>0, isAdministrator)}">
                                        <ul>
                                        <!-- <li class="searachableclass slds-is-active"><a href="javascript:void(0);" onclick="selectTab(this);checkSetupTabStepsCompletedFunc(); onTabEnterPushToInteractionLog('Setup'); " class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="Setup"  title="Setup" >Setup</a></li> -->
                                        <li class="nestedcheck"><a href="javascript:void(0);" style="padding-left: 0px;" onclick="showHideNestedMenu(this);" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="Configuration"  title="Configuration" >
                                            <svg aria-hidden="true" class="slds-section__title-action-icon slds-button__icon slds-button__icon--left">
                                                <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                            </svg>
                                            Configuration
                                            </a>
                                            <ul class="slds-list--vertical slds-has-block-links slds-is-nested slds-hide">
                                                <li class="searachableclass slds-list__item"><a href="javascript:void(0);" onclick="loadIframesfun('SetupAndConfig-TAB2','{!$Page.BreadwinnerOptionalSettings}');selectTab(this);onTabEnterPushToInteractionLog('Invoice Configuration');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="InvoiceContent" title="Invoice" >Invoice</a></li>
                                                <li class="searachableclass slds-list__item"><a href="javascript:void(0);" onclick="queryappconfigdynamic('Bill');selectTab(this);onTabEnterPushToInteractionLog('Bills Configuration');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="BillsContent" title="Bills">Bills</a></li>
                                                <li class="searachableclass slds-list__item"><a href="javascript:void(0);" onclick="queryappconfigdynamic('PO');selectTab(this);onTabEnterPushToInteractionLog('Pos Configuration');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="POsContent" title="Purchase Orders">POs</a></li>
                                            </ul>
                                        </li>
                                    </ul>
                                    </apex:outputPanel>
                                    <h2 class="slds-text-title--caps slds-p-around--medium" id="LEARN">LEARN</h2>
                                    <ul>
                                        <li class="searachableclass"><a href="javascript:void(0);" onclick="loadIframesfun('Knowledge_BasePage','{!BW_SupportPortalURL}/?t=711658');selectTab(this);RerenderRight();onTabEnterPushToInteractionLog('KnowledgeBase');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="KnowledgeBase" title="Knowledge Base" >Knowledge Base</a></li>
                                        <li class="searachableclass"><a href="javascript:void(0);" onclick="loadIframesfun('Contact_SupportPage','{!BW_SupportPortalURL}/customer/portal/emails/new?t=711718');selectTab(this);RerenderRight();onTabEnterPushToInteractionLog('Support');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="ContactSupport" title="Contact Support">Contact Support</a></li>
                                    </ul>
                                    <h2 class="slds-text-title--caps slds-p-around--medium" id="ADMIN">ADMIN</h2>
                                    <ul>
                                        <li class="searachableclass"><a href="javascript:void(0);" onclick="selectTab(this);onTabEnterPushToInteractionLog('Billing');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="Billing" title="Billing" >Billing</a></li>
                                        <li class="nestedcheck"><a href="javascript:void(0);" style="padding-left: 0px;" onclick="showHideNestedMenu(this);" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="Troubleshoot" title="Troubleshoot">
                                            <svg aria-hidden="true" class="slds-section__title-action-icon slds-button__icon slds-button__icon--left">
                                                <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                            </svg>
                                            Troubleshoot
                                            </a>
                                            <ul class="slds-list--vertical slds-has-block-links slds-is-nested slds-hide">
                                                <li class="searachableclass slds-list__item "><a href="javascript:void(0);" onclick="loadIframesfun('ADMIN-21','{!$Page.TroubleshootingPage}');selectTab(this);onTabEnterPushToInteractionLog('Troubleshooting');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="Troubleshooting" title="Troubleshooting" >Troubleshooting</a></li>
                                                <li class="searachableclass slds-list__item"><a href="javascript:void(0);" onclick="selectTab(this);onTabEnterPushToInteractionLog('Status Log');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="StatusLogs" title="Status Logs">Status Logs</a></li>
                                            </ul>
                                        </li>
                                        <ul >
                                                <li style="display:{!if(isBusinessOrHigher,'','none')}" class="{!if(isBusinessOrHigher,'searachableclass','')} slds-list__item "><a href="javascript:void(0);" onclick="loadIframesfun('ADMIN-23','{!$page.OpportunityBatchInvoicePage}');queryappconfigdynamic('BillPO');selectTab(this);onTabEnterPushToInteractionLog('Batch Invoice');" class="slds-truncate slds-navigation-list--vertical__action slds-text-link--reset" id="BatchInvoice" title="Batch (Beta)" style="color: grey;">Batch (Beta)</a></li>
                                        </ul>    
                                    </ul>
                                </div>
                            </div>
                            <div class="slds-size--1-of-1 slds-medium-size--5-of-6 slds-large-size--10-of-12 slds-m-bottom--large" style="border-left: 1px solid gray;">
                                <div id="breadwinner-right-content">
                                    
                                    
                                    <div id="SetupAndConfig-TAB1" class="slds-show" aria-labelledby="Setup">
                                        <!-- -----------------------------BreadwinnerHome Tab header start ---------------------------->
                                        <div class="slds-page-header" role="banner">
                                            <div class="slds-media">
                                                <div class="slds-media__figure">
                                                    <span class="slds-icon_container slds-icon-custom-custom3" title="Setup">
                                                        <svg aria-hidden="true" class="slds-icon">
                                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/custom-sprite/svg/symbols.svg#custom3')}"></use>
                                                        </svg>
                                                    </span>
                                                </div>
                                                <div class="slds-media__body">
                                                    <p class="slds-page-header__title slds-truncate" title="Breadwinner Setup">Setup</p>
                                                    <p class="slds-text-body--small">Breadwinner â€¢ Xero </p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- -----------------------------BreadwinnerHome Tab header END ---------------------------->
                                       
                                       <apex:outputLabel rendered="{! AND( NOT( ISBLANK(bwSetting.Endpoint_URL_Override__c)), bwSetting.Endpoint_URL_Override__c <> BW_API_BaseURL)}" style="font-size:24px; color: darkred; "><br/><center>You are using the endpoint {!bwSetting.Bread_Winner__Endpoint_URL_Override__c}</center></apex:outputLabel>
                                        <apex:pagemessage detail="Breadwinner is not able to sync your Xero data, there could be some validations or triggers on your Account or Opportunity which are causing the issue, please check for errors in Status Log Tab, or restart the Account Sync" severity="WARNING" rendered="{!AND(isOrgOutOfInvoiceSync, orgStatus !='expired')}" title=""></apex:pagemessage>
                                        
                                        <div class="slds-m-top--xx-large slds-m-horizontal--x-small" >
                                            <!-- ----------- Schedule job status Start-------------- -->
                                            <apex:outputPanel layout="block" rendered="{!isAdministrator}" id="InactiveUserMessage">
                                                <apex:outputPanel layout="block" styleClass="warningM3" style="border-radius:4px;" rendered="{!NOT(areScheduledJobsRunbyActiveUser)}">
                                                    Breadwinner scheduled Jobs are running from an Inactive User. Visit the <a href="javascript:void(0);" style="color:black" onclick="OpenTroubleshootTab();loadIframesfun('ADMIN-21','{!$Page.TroubleshootingPage}');">Troubleshooting tab</a> to fix this.
                                                </apex:outputPanel>
                                            </apex:outputPanel>
                                            <!-- ----------- Schedule job status END---------------- -->
                                            
                                            <!-- ----------- Progress Bar Start-------------- -->
                                            <apex:outputPanel layout="block" styleClass="slds-text-heading--medium slds-m-bottom--xx-large" id="progressPanel">
                                                
                                                <apex:outputPanel >
                                                    <apex:outputPanel rendered="{!NOT(isConsumerDetailFilled)}">
                                                        <div display="block" class="slds-m-left--xx-small" > Congratulations! You are 20% complete! </div>
                                                        <div class="progress-bar">
                                                            <span  style="width: 20%"></span> 
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!AND(isConsumerDetailFilled,NOT(isAccountSyncDone))}">
                                                        <div display="block" class="slds-m-left--xx-small"  > Congratulations! You are 40% complete! </div>
                                                        <div class="progress-bar">
                                                            <span  style="width: 40%"></span>
                                                        </div>
                                                    </apex:outputPanel>
                                                    
                                                    <apex:outputPanel rendered="{!AND(isConsumerDetailFilled,isAccountSyncDone,isHistoricalInvoiceSyncStarted,AND(NOT(unableToAddRemoteSiteSetting),NOT(isLayoutUpdated)))}">
                                                        <div display="block" class="slds-m-left--xx-small"  > Congratulations! You are 60% complete! </div> 
                                                        <div class="progress-bar">
                                                            <span  style="width: 60%"></span> 
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!AND(isConsumerDetailFilled,isAccountSyncDone,OR(unableToAddRemoteSiteSetting,isLayoutUpdated), (orgStatus !='subscribed' && NOT(isSandbox || isDeveloperEdition)) )}">
                                                        <div display="block" class="slds-m-left--xx-small"  > Congratulations! You are 80% complete! </div> 
                                                        <div class="progress-bar">
                                                            <span  style="width: 80%"></span> 
                                                        </div>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!AND(isConsumerDetailFilled,isAccountSyncDone,OR(unableToAddRemoteSiteSetting,isLayoutUpdated),(orgStatus =='subscribed' || (isSandbox || isDeveloperEdition)))}">
                                                        <div display="block" class="slds-m-left--xx-small"  > Congratulations! You are 100% complete! </div> 
                                                        <div class="progress-bar">
                                                            <span  style="width: 100%"></span> 
                                                        </div>
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                            </apex:outputPanel>
                                            <!-- ----------- Progress Bar End---------------- -->
                                            
                                            <!------------- Free Trail info Block starts here ------------- -->
                                            <table  class="slds-table slds-table--bordered slds-max-medium-table--stacked slds-no-row-hover" cellpadding="0" cellspacing="0" border="0">
                                                <tr>
                                                    <td style="width:43%">
                                                        <div class="slds-text-heading--medium">
                                                            <apex:outputPanel rendered="{!IF(orgStatus =='subscribed', true, false)}">
                                                                You have an active, valid subscription to Breadwinner.
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!IF(orgStatus =='trial', true, false)}">
                                                                Your fully-featured 14-day free trial has been activated.
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!IF(orgStatus =='expired', true, false)}">
                                                                Your Data Subscription to Breadwinner has Expired.
                                                            </apex:outputPanel>
                                                        </div>
                                                         <apex:outputPanel rendered="{!IF(orgStatus =='expired', true, false)}" styleClass="slds-text-body--small" > 
                                                            Please contact sales@breadwinner.com
                                                         </apex:outputPanel>
                                                    </td>
                                                    <td style="width: 4%;">
                                                        <div class="textDiv">
                                                            <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!IF(orgStatus =='subscribed', true, false)}"/>
                                                            <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!IF(orgStatus =='trial', true, false)}"/>                              
                                                            <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png')}" rendered="{!IF(orgStatus =='expired', true, false)}"/> 
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <apex:outputPanel styleClass="slds-text-heading--medium" rendered="{!IF(orgStatus =='trial', true, false)}">
                                                            Your trial will expire in {!noOfDaysLeft} Days.
                                                        </apex:outputPanel>
                                                    </td>
                                                </tr>
                                                
                                            </table>
                                            <!------------- Free Trail info Block ends here --------------- -->
                                            
                                            <!------------ Setup for Single Org Starts here ------- -->
                                            <apex:outputPanel rendered="{!NOT(isMultiOrgEnabled)}">
                                                <table class="slds-table slds-table--bordered slds-max-medium-table--stacked slds-no-row-hover" >
                                                    <tr>
                                                        <td style="width: 43%;border-top-color: white;">
                                                            <apex:outputPanel id="consumerHeaderPanel">
                                                                <div class="slds-text-heading--medium">
                                                                    Connect Breadwinner / Salesforce to Xero
                                                                </div> 
                                                                <apex:outputPanel rendered="{!bwSetting.Bread_Winner__New_Interface__c}" styleClass="slds-text-body--small" >
                                                                    Need to connect more than one Xero org to Salesforce? Please&nbsp;
                                                                    <apex:outputLink onclick="OpenContactSupportTab();loadIframesfun('Contact_SupportPage','{!BW_SupportPortalURL}/customer/portal/emails/new?t=711718');" value="javascript:void(0);">contact Breadwinner Support</apex:outputLink>
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                        </td>
                                                        <td style="width: 4%;border-top-color: white;"> 
                                                            <apex:outputPanel id="consumerDetailCheckIconPanel">
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!AND(isConsumerDetailFilled , !isOAuthIssue)}"/>  
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/yellow_check.png')}" rendered="{!AND(isOAuthIssue, isConsumerDetailFilled)}"/> 
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png')}" rendered="{!!isConsumerDetailFilled}"/>
                                                            </apex:outputPanel>
                                                        </td>
                                                        <td style="border-top-color: white;" > 
                                                            <div class="textDiv">
                                                                <apex:outputPanel id="consumerDetailLinkPanel">
                                                                    <apex:outputPanel rendered="true">
                                                                        <apex:outputLink rendered="{!AND(NOT(isConsumerDetailFilled),orgStatus !='expired')}" value="{!bwSetting.Bread_Winner__Endpoint_URL_Override__c}/api/xero/auth/{!$Organization.Id}?callbackurl={!URLENCODE(URLFOR($Page.Bread_Winner__CompleteAuth))}" ><!--value="{!publicAppConnectionURL}"-->
                                                                            <apex:image url="{!BW_HostedImageURL}/xero_connect_buttons/connect_xero_button_blue.png"/>
                                                                        </apex:outputLink>
                                                                        <apex:outputPanel rendered="{!AND(bwSetting.Bread_Winner__New_Interface__c, OR(isConsumerDetailFilled,orgStatus =='expired'), listAppConfig.size>0)}">
                                                                            <div class="slds-text-heading--medium">{!xero_Org_Name} is Connected</div> 
                                                                            <apex:outputPanel rendered="{!isAdministrator}">
                                                                                <apex:variable value="BreadwinnerOptionalSettings?id={!xero_Org_Id}" var="url1"/>
                                                                                <apex:outputLink styleClass="slds-text-body--small" style="color:gray" value="{!($Page.Bread_Winner__InventoryImportPage)}?id={!xero_Org_Id}">Import Inventory from Xero</apex:outputLink>
                                                                                &nbsp;&nbsp;
                                                                                <apex:outputLink styleClass="{!IF(isOAuthIssue, 'slds-text-heading--medium slds-text-color--error', 'slds-text-body--small')} " style="color:{!IF(isOAuthIssue, '', 'gray')}"  value="{!bwSetting.Bread_Winner__Endpoint_URL_Override__c}/api/xero/auth/{!$Organization.Id}?callbackurl={!URLENCODE(URLFOR($Page.Bread_Winner__CompleteAuth))}">{!IF(isOAuthIssue&&isAdministrator,"Please reconnect with Xero","Reconnect")}</apex:outputLink>
                                                                                &nbsp;
                                                                                <apex:commandlink styleClass="slds-text-body--small" style="color:gray" value="Disconnect" status="assign-action-status" onclick="return confirm('This will only delete the connection with this Xero Org. \n\n Are you sure to delete?');" action="{!DisconnectAppConfig}"> 
                                                                                    <apex:param name="xeroOrgToDisconnect" assignTo="{!xeroOrgToDisconnect}" value="{!AppConfigId}"/>
                                                                                </apex:commandlink>
                                                                            </apex:outputPanel>
                                                                            
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    
                                                                    <apex:outputPanel layout="block" rendered="{!NOT(bwSetting.Bread_Winner__New_Interface__c)}">
                                                                        <apex:outputPanel rendered="{!isConsumerDetailFilled}" styleClass="slds-text-body--small" id="reEnterConsumerDetails">  
                                                                            If asked by support, you may wish to&nbsp;
                                                                            <apex:commandLink style="color:gray;" action="{!showConsumerDetailEditSection}" status="assign-action-status" reRender="ConsumerSettingPanel" >re-enter Consumer Key and Secret
                                                                            </apex:commandLink>  
                                                                            <apex:outputPanel style="font-size:16px;" rendered="{!isAdministrator}" >
                                                                                <br/>
                                                                                <apex:commandLink onclick=" return ReconnectToXero();" action="{!deleteAppConfig}" style="color:red;"  status="assign-action-status">Reconnect to Xero - this allows you to have the latest features</apex:commandLink>
                                                                            </apex:outputPanel>    
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </td>
                                                    </tr>              
                                                    <tr style="display:{!IF(isEditSection,'','none')};">
                                                        <td style="border:none; border-top:0px;" colspan="2">
                                                            
                                                            <apex:outputPanel id="ConsumerSettingPanel">
                                                                
                                                                <apex:outputPanel rendered="{!isEditSection}">
                                                                    
                                                                    <a Class="slds-text-body--small" target="_blank" href="{!BW_SupportPortalURL}/customer/portal/articles/1637728-how-to-connect-salesforce-to-xero-through-breadwinner---oauth?b_id=3546">Instructions on Connecting Salesforce to Xero</a>
                                                                    <!-- Settings Info --> 
                                                                    <apex:pageMessages id="PageMessage"></apex:pageMessages>
                                                                    <apex:outputPanel layout="block" styleClass="warningM3" style="border-radius:4px;" rendered="{!consumerDetailsLengthIncorrect}">
                                                                        <b> Incorrect Consumer details </b> <br/>
                                                                        <apex:outputPanel style="margin-left:2%;">
                                                                            <apex:outputLabel value="The Consumer Key and Secret are not the correct length. This often happens when people create a Public App in Xero rather than a Private App. Please check that you have ticked the radio box for 'Private' while creating the App in Xero. Alternatively, please "></apex:outputLabel> 
                                                                            <apex:outputLink onclick="OpenContactSupportTab();loadIframesfun('Contact_SupportPage','{!BW_SupportPortalURL}/customer/portal/emails/new?t=711718');" value="javascript:void(0);">contact Breadwinner Support</apex:outputLink>
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    
                                                                    <apex:outputPanel layout="block" styleClass="warningM3" style="border-radius:4px;" rendered="{!consumerDetailsInvalid}">
                                                                        <b> Xero rejected these values. </b> <br/>
                                                                        <apex:outputPanel style="margin-left:2%;">
                                                                            <apex:outputLabel value="They might have been copied and pasted incorrectly, or there might be an issue with your Xero login. Please "></apex:outputLabel> 
                                                                            <apex:outputLink onclick="OpenContactSupportTab();loadIframesfun('Contact_SupportPage','{!BW_SupportPortalURL}/customer/portal/emails/new?t=711718');" value="javascript:void(0);">contact Breadwinner Support</apex:outputLink>
                                                                            <apex:outputLabel value=" so that we can help you to resolve this."></apex:outputLabel> 
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    
                                                                    <div class="slds-grid slds-wrap slds-m-top--medium">
                                                                        <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                                                            <div class="slds-size--1-of-1 slds-medium-size--1-of-1 slds-large-size--1-of-1">
                                                                                <div class="slds-form-element">
                                                                                    <label class="slds-form-element__label" >Consumer Key</label>
                                                                                    <div class="slds-form-element__control">
                                                                                        <apex:inputSecret value="{!consumerKey}" styleClass="slds-input" redisplay="true"/>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-1 slds-m-top--small">
                                                                                <div class="slds-form-element">
                                                                                    <label class="slds-form-element__label" >Consumer Secret</label>
                                                                                    <div class="slds-form-element__control">
                                                                                        <apex:inputSecret value="{!consumerSecret}" styleClass="slds-input" redisplay="true"/>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-m-top--medium slds-m-left--xx-large" >
                                                                        <apex:commandButton value="Save" styleClass="slds-button slds-button--brand" action="{!save}" 
                                                                                            reRender="ConsumerSettingPanel, PageMessage, scriptPanel, consumerDetailCheckIconPanel, consumerDetailLinkPanel,consumerHeaderPanel,accountSyncPanel,progressPanel, infoPanel" 
                                                                                            status="assign-action-status" oncomplete="displayMessageOnSave();"/>
                                                                        
                                                                        <apex:commandButton value="Cancel" styleClass="slds-button slds-button--neutral" action="{!cancel}" reRender="ConsumerSettingPanel, PageMessage" status="assign-action-status"/>
                                                                    </div>
                                                                </apex:outputPanel>                                    
                                                            </apex:outputPanel>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>  
                                                            <div >
                                                                <apex:outputPanel id="accountSyncPanel">
                                                                    <apex:outputPanel styleClass="slds-text-heading--medium" rendered="{!IF(OR(isAccountSyncDone,NOT(isConsumerDetailFilled), NOT(isAdministrator), AND(OR(appconfig.Bread_Winner__Sync_Suppliers_Bills__c,appconfig.Bread_Winner__Sync_POs__c), isConsumerDetailFilled, isAdministrator, isBusinessOrHigher)),true,false)}">
                                                                        Sync Xero Contacts to Salesforce Accounts                                  
                                                                    </apex:outputPanel>
                                                                    <apex:outputLink rendered="{!IF(AND(AND(Not(AND(OR(appconfig.Bread_Winner__Sync_Suppliers_Bills__c, appconfig.Bread_Winner__Sync_POs__c), isBusinessOrHigher)), NOT(appconfig.Bread_Winner__Sync_POs__c && isSupplierSyncDone && isBusinessOrHigher)), Not(isAccountSyncDoneforCustomers), isConsumerDetailFilled, isAdministrator),true,false)}" styleClass="slds-text-heading--medium" style="color:black" value="/apex/BreadwinnerAccountSync">Preview the Account Sync</apex:outputLink>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </td>
                                                        <td> 
                                                            <apex:outputPanel id="SyncViewImg">
                                                            <div class="textDiv">
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!isAccountSyncDone}"/>
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png')}" rendered="{!!isAccountSyncDone}"/>
                                                            </div>
                                                            </apex:outputPanel>
                                                        </td>
                                                        <td > 
                                                            <div class="textDiv">
                                                                <apex:outputPanel id="SynView">
                                                                    <apex:outputpanel rendered="{!AND(OR(appconfig.Bread_Winner__Sync_Suppliers_Bills__c, appconfig.Bread_Winner__Sync_POs__c), isBusinessOrHigher)}">
                                                                        <apex:outputLink rendered="{!IF(AND(OR(appconfig.Bread_Winner__Sync_Suppliers_Bills__c, appconfig.Bread_Winner__Sync_POs__c),isConsumerDetailFilled, isAdministrator, !isAccountSyncDoneforCustomers),true,false)}" styleClass="slds-text-body--small" style="color:gray;" value="/apex/BreadwinnerAccountSync" ><apex:outputText value="{!if(isAccountSyncDone,'Start ','Preview ')}"/>the Account Sync for Customers<br/></apex:outputLink>       
                                                                        <apex:outputLink rendered="{!IF(AND(appconfig.Bread_Winner__Sync_Suppliers_Bills__c,isConsumerDetailFilled, isAdministrator, !isSupplierSyncDone, isBusinessOrHigher),true,false)}" styleClass="slds-text-body--small" style="color:gray;" value="/apex/BreadwinnerAccountSync?supplier=true" ><apex:outputText value="{!if(isAccountSyncDone,'Start ','Preview ')}"/>the Account Sync for Suppliers<br/></apex:outputLink>     
                                                                        <apex:outputLink rendered="{!IF(AND(appconfig.Bread_Winner__Sync_POs__c,isConsumerDetailFilled, isAdministrator, !isPOContactSyncDone, isBusinessOrHigher),true,false)}" styleClass="slds-text-body--small" style="color:gray;" value="/apex/BreadwinnerAccountSync?purchaseorder=true" ><apex:outputText value="{!if(isAccountSyncDone,'Start ','Preview ')}"/>the Account Sync for Xero Contacts with Purchase Orders<br/></apex:outputLink>     
                                                                    </apex:outputpanel>     
                                                                    
                                                                    <apex:outputPanel rendered="{!AND(isAdministrator, isAccountSyncDone)}" >       
                                                                        <apex:outputPanel rendered="{!AND(isAdministrator, OR(isAccountSyncDoneforCustomers, AND(isSupplierSyncDone, appconfig.Bread_Winner__Sync_Suppliers_Bills__c),AND(isPOContactSyncDone, appconfig.Bread_Winner__Sync_POs__c) ))}" styleClass="slds-text-body--small">If asked by support, you may wish to&nbsp;</apex:outputPanel>
                                                                        <apex:outputPanel rendered="{!AND(isAdministrator, isAccountSyncDoneforCustomers)}" >
                                                                            
                                                                            <apex:outputLink rendered="{!AND(isAccountSyncDone, !appconfig.Bread_Winner__Sync_Suppliers_Bills__c)}"   value="/apex/BreadwinnerAccountSync" styleClass="slds-text-body--small" style="color:gray;" >restart the Account Sync
                                                                            </apex:outputLink>
                                                                            <apex:outputLink rendered="{!AND(isAccountSyncDoneforCustomers, appconfig.Bread_Winner__Sync_Suppliers_Bills__c )}"   value="/apex/BreadwinnerAccountSync" styleClass="slds-text-body--small" style="color:gray;">restart the Account Sync for Customers</apex:outputLink>
                                                                            
                                                                        </apex:outputPanel>          
                                                                        <apex:outputpanel rendered="{!(isSupplierSyncDone && appconfig.Bread_Winner__Sync_Suppliers_Bills__c && isBusinessOrHigher)}">               
                                                                            <apex:outputText styleClass="slds-text-body--small" value="{!if(isAccountSyncDoneforCustomers, ', ' ,'restart Account Sync for')}"/>&nbsp;             
                                                                            <apex:outputLink value="/apex/BreadwinnerAccountSync?supplier=true" styleClass="slds-text-body--small" style="color:gray;">Suppliers             
                                                                            </apex:outputLink>              
                                                                        </apex:outputpanel>
                                                                        <apex:outputpanel rendered="{!(isPOContactSyncDone && appconfig.Bread_Winner__Sync_POs__c && isBusinessOrHigher)}">
                                                                            
                                                                            <apex:outputText styleClass="slds-text-body--small" value="{!if(NOT(isAccountSyncDoneforCustomers|| AND(isSupplierSyncDone, appconfig.Bread_Winner__Sync_Suppliers_Bills__c)), 'restart Account Sync for', if(AND(appconfig.Bread_Winner__Is_Supplier_Sync_Completed__c, appconfig.Bread_Winner__Sync_Suppliers_Bills__c), ', or',' or'))}"/>&nbsp;
                                                                            <apex:outputLink value="/apex/BreadwinnerAccountSync?purchaseorder=true" styleClass="slds-text-body--small" style="color:gray;">Xero Contacts with Purchase Orders             
                                                                            </apex:outputLink>
                                                                        </apex:outputpanel>                                                 
                                                                    </apex:outputPanel>  
                                                                </apex:outputPanel>
                                                                
                                                            </div>                              
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="slds-text-heading--medium">
                                                                Sync Invoices (starts automatically)
                                                            </div>                                    
                                                        </td>
                                                        <td> 
                                                            <div class="textDiv">
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!isAccountSyncDone}"/>  
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png')}" rendered="{!!isAccountSyncDone}"/>
                                                            </div>                                    
                                                        </td>  
                                                        <td >
                                                            <div class="slds-text-body--small">
                                                                <apex:outputPanel id="opId1" rendered="{!AND(isAdministrator, isAccountSyncDone)}" > 
                                                                    
                                                                    If asked by support, you may wish to&nbsp; 
                                                                    <apex:commandLink action="{!restartHistoricalSync}" style="color:grey;" status="assign-action-status" reRender="RestartHistoricalSyncScriptPanel" onComplete="onCompletionOfRestartHistoricalSync();">restart the Invoice Sync 
                                                                    </apex:commandLink>
                                                                    <br/>
                                                                    If asked by support, you may wish to&nbsp;
                                                                    <apex:commandLink action="{!refreshXeroAccountingDetails}" style="color:grey;" status="assign-action-status" reRender="opId1" onclick="confirmRefreshing();">refresh your Invoice Template, Currencies, Tax Codes, or Revenue Codes
                                                                    </apex:commandLink>
                                                                    
                                                                </apex:outputPanel>
                                                            </div>
                                                        </td>                          
                                                    </tr>
                                                </table>
                                            </apex:outputPanel>
                                            <!------------ Setup for Single Org Ends here ------- -->
                                            
                                            <apex:outputPanel rendered="{!AND(isMultiOrgEnabled,isAdministrator)}">
                                                <table class=" slds-table slds-table--bordered slds-max-medium-table--stacked slds-no-row-hover">
                                                    <tr>
                                                        <td style="width:43%;border-top-color: white;">
                                                            <div class="slds-text-heading--medium">
                                                                <apex:outputPanel id="consumerHeaderPanelMO">
                                                                    Connect Breadwinner / Salesforce to Xero
                                                                </apex:outputPanel>
                                                            </div>
                                                        </td>
                                                        <td style="width:4%;border-top-color: white;"> 
                                                            <div >
                                                                <apex:outputPanel id="consumerDetailCheckIconPanelMO">
                                                                    <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!AND(!isOAuthIssue, isConsumerDetailFilled)}"/>                                            
                                                                    <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/yellow_check.png')}" rendered="{!AND(isOAuthIssue, isConsumerDetailFilled)}"/>  
                                                                    <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png')}" rendered="{!!isConsumerDetailFilled}"/> 
                                                                </apex:outputPanel>
                                                            </div>
                                                        </td>
                                                        <td style="border-top-color: white;"> 
                                                            <div >
                                                                <apex:outputPanel id="consumerDetailLinkPanelMO">
                                                                    
                                                                    <apex:outputLink rendered="{!AND(NOT(isConsumerDetailFilled),orgStatus !='expired')}" value="{!bwSetting.Bread_Winner__Endpoint_URL_Override__c}/api/xero/auth/{!$Organization.Id}?callbackurl={!URLENCODE(URLFOR($Page.Bread_Winner__CompleteAuth))}" ><!--value="{!publicAppConnectionURL}"-->
                                                                        <apex:image url="{!BW_HostedImageURL}/xero_connect_buttons/connect_xero_button_blue.png"/>
                                                                    </apex:outputLink>
                                                                    <apex:outputPanel rendered="{!AND(OR(isConsumerDetailFilled,orgStatus =='expired'), listAppConfig.size>0)}">
                                                                        <apex:repeat value="{!listAppConfig}" var="appC">
                                                                            
                                                                            <div class="slds-text-heading--medium slds-m-top--small">
                                                                                {!appC.Bread_Winner__Connecting_App_Name__c} is Connected
                                                                            </div>
                                                                            
                                                                            <apex:outputPanel rendered="{!isAdministrator}">
                                                                                <apex:variable value="BreadwinnerOptionalSettings?id={!appC.Bread_Winner__Xero_Org_ID__c}" var="url2"/>
                                                                                <apex:outputLink styleClass="slds-text-body--small" style="color:grey;" value="{!($Page.Bread_Winner__InventoryImportPage)}?id={!appC.Bread_Winner__Xero_Org_ID__c}">Import Inventory from Xero</apex:outputLink>&nbsp;&nbsp;
                                                                                <apex:outputLink styleClass="{!IF(appC.Bread_Winner__Active__c, 'slds-text-heading--medium slds-text-color--error', 'slds-text-body--small')} " style="color:{!IF(appC.Bread_Winner__Active__c, 'red', 'gray')}" value="{!bwSetting.Bread_Winner__Endpoint_URL_Override__c}/api/xero/auth/{!$Organization.Id}?callbackurl={!URLENCODE(URLFOR($Page.Bread_Winner__CompleteAuth))}">{!IF( AND(appC.Bread_Winner__Active__c, isAdministrator),"Please reconnect with Xero","Reconnect")}</apex:outputLink>
                                                                                &nbsp;
                                                                                <apex:commandlink styleClass="slds-text-body--small" style="color:grey;" value="Disconnect" status="assign-action-status" onclick="return confirm('This will only delete the connection with this Xero Org. \n\n Are you sure to delete?');" action="{!DisconnectAppConfig}"> 
                                                                                    <apex:param name="xeroOrgToDisconnect" assignTo="{!xeroOrgToDisconnect}" value="{!appC.Id}"/>
                                                                                </apex:commandlink>
                                                                                
                                                                                <br/>
                                                                            </apex:outputPanel>
                                                                        </apex:repeat>
                                                                        
                                                                        <div class="slds-m-top--small">
                                                                            <apex:outputLink styleClass="slds-text-body--small" style="color:grey;" value="{!bwSetting.Bread_Winner__Endpoint_URL_Override__c}/api/xero/auth/{!$Organization.Id}?callbackurl={!URLENCODE(URLFOR($Page.Bread_Winner__CompleteAuth))}" rendered="{!AND(isAdministrator, orgStatus !='expired')}" >
                                                                                Add another Xero Org
                                                                            </apex:outputLink>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                    
                                                                    
                                                                    
                                                                </apex:outputPanel>
                                                            </div>
                                                        </td>
                                                    </tr>              
                                                    <tr>
                                                        <td>  
                                                            <div class="slds-text-heading--medium">
                                                                <apex:outputPanel >
                                                                    Sync Xero Contacts to Salesforce Accounts                                  
                                                                </apex:outputPanel>
                                                            </div>
                                                        </td>
                                                        <td> 
                                                            <div >
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!AND(isAccountSyncDone, OR(DoneAllContactsSyn, listAppConfig.size<2))}"/>
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/yellow_check.png')}" rendered="{!AND(isAccountSyncDone,AND(!DoneAllContactsSyn, listAppConfig.size>1))}"/>
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png')}" rendered="{!!isAccountSyncDone}"/>
                                                            </div>
                                                        </td>
                                                        <td > 
                                                            <div >
                                                              <apex:outputPanel id="MutliOrgAccountSyncView">
                                                                
                                                                <apex:variable var="count" value="{!1}" />
                                                                <apex:repeat value="{!listAppConfig}" var="appC">
                                                                    <apex:outputPanel rendered="{!AND(isAdministrator, OR(appC.Bread_Winner__Is_Account_Sync_Completed__c, AND(appC.Bread_Winner__Is_Supplier_Sync_Completed__c, appC.Bread_Winner__Sync_Suppliers_Bills__c) , AND(appC.Bread_Winner__Is_PO_Contact_Sync_Completed__c, appC.Bread_Winner__Sync_POs__c)))}" style="color:grey; font-size:12px;">If asked by support, you may wish to&nbsp;</apex:outputPanel>
                                                                    <apex:outputPanel rendered="{!AND(appC.Bread_Winner__Is_Account_Sync_Completed__c, OR(AND(!appC.Bread_Winner__Sync_Suppliers_Bills__c , !appC.Bread_Winner__Sync_POs__c), !isBusinessOrHigher))}" styleClass="slds-text-body--small" style="color:grey;">
                                                                        <apex:outputLink value="{!($Page.Bread_Winner__BreadwinnerAccountSync)}?xeroOrg={!URLENCODE(appC.Name)}"  >restart the Account Sync</apex:outputLink>
                                                                        &nbsp;for {!appC.Bread_Winner__Connecting_App_Name__c}.
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel rendered="{!AND(appC.Bread_Winner__Is_Account_Sync_Completed__c, AND(OR(appC.Bread_Winner__Sync_Suppliers_Bills__c, appC.Bread_Winner__Sync_POs__c), isBusinessOrHigher))}" styleClass="slds-text-body--small" style="color:grey;">
                                                                        
                                                                        <apex:outputLink value="{!($Page.Bread_Winner__BreadwinnerAccountSync)}?xeroOrg={!URLENCODE(appC.Name)}"  >restart the Account Sync for Customers</apex:outputLink>      
                                                                    </apex:outputPanel>
                                                                    
                                                                    <apex:outputPanel rendered="{!appC.Bread_Winner__Is_Supplier_Sync_Completed__c && appC.Bread_Winner__Sync_Suppliers_Bills__c && isBusinessOrHigher}" styleClass="slds-text-body--small" style="color:grey;">      
                                                                        <apex:outputText styleClass="slds-text-body--small" value="{!if(appC.Bread_Winner__Is_Account_Sync_Completed__c, ', ' ,'restart Account Sync for')}"/>&nbsp;
                                                                        <apex:outputLink value="{!($Page.Bread_Winner__BreadwinnerAccountSync)}?xeroOrg={!URLENCODE(appC.Name)}&supplier=true" styleClass="slds-text-body--small" style="color:grey;" >Suppliers</apex:outputLink>       
                                                                        
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel rendered="{!appC.Bread_Winner__Is_PO_Contact_Sync_Completed__c && appC.Bread_Winner__Sync_POs__c && isBusinessOrHigher}" styleClass="slds-text-body--small" style="color:grey;">      
                                                                        <apex:outputText styleClass="slds-text-body--small" value="{!if(NOT(appC.Bread_Winner__Is_Account_Sync_Completed__c||(appC.Bread_Winner__Is_Supplier_Sync_Completed__c && appC.Bread_Winner__Sync_Suppliers_Bills__c)),'restart Account Sync for', if(AND(appC.Bread_Winner__Is_Supplier_Sync_Completed__c, appC.Bread_Winner__Sync_Suppliers_Bills__c),', or',' or') )}"/>&nbsp;
                                                                        <apex:outputLink value="{!($Page.Bread_Winner__BreadwinnerAccountSync)}?xeroOrg={!URLENCODE(appC.Name)}&purchaseorder=true" style="color:grey;" >Xero Contacts with Purchase Orders</apex:outputLink>
                                                                        
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel rendered="{!AND(appC.Bread_Winner__Is_Account_Sync_Completed__c, AND(OR(appC.Bread_Winner__Sync_Suppliers_Bills__c, appC.Bread_Winner__Sync_POs__c), isBusinessOrHigher))}" styleClass="slds-text-body--small" style="color:grey;">&nbsp;for {!appC.Bread_Winner__Connecting_App_Name__c}.</apex:outputPanel>
                                                                    
                                                                    <apex:outputPanel styleClass="slds-text-body--small"  rendered="{!AND(NOT(appC.Bread_Winner__Is_Account_Sync_Completed__c),!OR(appC.Bread_Winner__Sync_Suppliers_Bills__c, appC.Bread_Winner__Sync_POs__c))}">       
                                                                        <apex:outputLink value="{!($Page.Bread_Winner__BreadwinnerAccountSync)}?xeroOrg={!URLENCODE(appC.Name)}" rendered="{!isAdministrator}" style="{!IF(listAppConfig.size>1, 'color:red;', '' )}" ><apex:outputText value="{!if(isAccountSyncDone,'Start ','Preview ')}"/>the Account Sync for {!appC.Bread_Winner__Connecting_App_Name__c}</apex:outputLink>                                                       
                                                                    </apex:outputPanel>     
                                                                    <apex:outputPanel styleClass="slds-text-body--small"   rendered="{!AND(NOT(appC.Bread_Winner__Is_Account_Sync_Completed__c), OR(appC.Bread_Winner__Sync_Suppliers_Bills__c, appC.Bread_Winner__Sync_POs__c))}">       
                                                                        <apex:outputLink value="{!($Page.Bread_Winner__BreadwinnerAccountSync)}?xeroOrg={!URLENCODE(appC.Name)}" rendered="{!isAdministrator}" style="{!IF(listAppConfig.size>1, 'color:red;', '' )}" ><apex:outputText rendered="{!OR(AND(appC.Bread_Winner__Is_Supplier_Sync_Completed__c, appC.Bread_Winner__Sync_Suppliers_Bills__c), AND(appC.Bread_Winner__Is_PO_Contact_Sync_Completed__c, appC.Bread_Winner__Sync_POs__c))}"><br/></apex:outputText> <apex:outputText value="{!if(isAccountSyncDone,'Start ','Preview ')}"/>the Account Sync for&nbsp;<apex:outputText rendered="{!appC.Bread_Winner__Sync_Suppliers_Bills__c}">Customers for</apex:outputText> {!appC.Bread_Winner__Connecting_App_Name__c}</apex:outputLink>                                                     
                                                                    </apex:outputPanel>     
                                                                    <apex:outputPanel styleClass="slds-text-body--small"   rendered="{!AND(NOT(appC.Bread_Winner__Is_Supplier_Sync_Completed__c) , appC.Bread_Winner__Sync_Suppliers_Bills__c, isBusinessOrHigher)}"><br/>     
                                                                        <apex:outputLink value="{!($Page.Bread_Winner__BreadwinnerAccountSync)}?xeroOrg={!URLENCODE(appC.Name)}&supplier=true" rendered="{!isAdministrator}" style="{!IF(listAppConfig.size>1, 'color:red;', '' )}" ><apex:outputText value="{!if(isAccountSyncDone,'Start ','Preview ')}"/>the Account Sync for Suppliers for {!appC.Bread_Winner__Connecting_App_Name__c}</apex:outputLink>
                                                                        
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel styleClass="slds-text-body--small"   rendered="{!AND(NOT(appC.Bread_Winner__Is_PO_Contact_Sync_Completed__c) , appC.Bread_Winner__Sync_POs__c, isBusinessOrHigher)}"><br/> 
                                                                        <apex:outputLink value="{!($Page.Bread_Winner__BreadwinnerAccountSync)}?xeroOrg={!URLENCODE(appC.Name)}&purchaseorder=true" rendered="{!isAdministrator}" style="{!IF(listAppConfig.size>1, 'color:red;', '' )}" ><apex:outputText value="{!if(isAccountSyncDone,'Start ','Preview ')}"/>the Account Sync for Xero Contacts with Purchase Orders for {!appC.Bread_Winner__Connecting_App_Name__c}</apex:outputLink>
                                                                    </apex:outputPanel>
                                                                    <br/>
                                                                    <apex:variable var="count" value="{!count+1}" />
                                                                    
                                                                </apex:repeat>
                                                                </apex:outputPanel>  
                                                            </div>                              
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <div class="slds-text-heading--medium">  Sync Invoices (starts automatically)
                                                                
                                                            </div>
                                                        </td>
                                                        <td> 
                                                            <div class="textDiv">
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!isAccountSyncDone}"/>  
                                                                <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png')}" rendered="{!!isAccountSyncDone}"/>
                                                            </div>
                                                        </td>  
                                                        <td Class="slds-text-body--small" >
                                                            <div >
                                                                <apex:outputPanel id="opId2" rendered="{!isAccountSyncDone}" style="color:grey;">   
                                                                    If asked by support, you may wish to&nbsp; 
                                                                    <apex:commandLink action="{!restartHistoricalSync}" style="color:grey;" status="assign-action-status" reRender="RestartHistoricalSyncScriptPanel" onComplete="onCompletionOfRestartHistoricalSync();">restart the Invoice Sync 
                                                                    </apex:commandLink>
                                                                    for All Xero Orgs
                                                                    <br/>
                                                                    If asked by support, you may wish to&nbsp;
                                                                    <apex:commandLink action="{!refreshXeroAccountingDetails}" style="color:grey;" status="assign-action-status" rerender="opId2" onclick="confirmRefreshing();">refresh your Invoice Template, Currencies, Tax Codes, or Revenue Codes
                                                                    </apex:commandLink>
                                                                    for All Xero Orgs
                                                                    
                                                                </apex:outputPanel>
                                                            </div>
                                                        </td>                          
                                                    </tr>
                                                </table>
                                            </apex:outputPanel>
                                            
                                            <table  class=" slds-table slds-table--bordered slds-max-medium-table--stacked slds-no-row-hover" cellpadding="0" cellspacing="0" border="0">
                                                
                                                <tr>
                                                    <td style="width:43%;border-top-color: white;">  
                                                        <div class="slds-text-heading--medium">
                                                            <apex:outputPanel id="pageLayoutHeadingPanel" >
                                                                
                                                                <script>    
                                                                var isExceptionfound="{!foundException}";
                                                                function showLayoutEditsection(){
                                                                    document.getElementById("showlayoutTRId").style.display="";
                                                                }
                                                                function HideLayoutEditsection(){
                                                                    
                                                                    if(isExceptionfound=='false'){
                                                                        document.getElementById("showlayoutTRId").style.display="none";
                                                                    }
                                                                    else{
                                                                        document.getElementById("showlayoutTRId").style.display="";
                                                                    }
                                                                }
                                                                </script> 
                                                                
                                                                <apex:outputPanel rendered="{!unableToAddRemoteSiteSetting && NOT(bwSetting.Bread_Winner__Page_Layouts_Updated__c)}" >
                                                                    <a  target="_blank" style="color:gray" href="{!BW_SupportPortalURL}/customer/portal/articles/1607408-configure-your-page-layouts">
                                                                        Read Instructions
                                                                    </a>
                                                                    on configuring your Page Layouts
                                                                    <div class="slds-text-body--small">
                                                                        (we can&apos;t monitor this, so no green check will appear)
                                                                    </div>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{!OR(NOT(unableToAddRemoteSiteSetting),bwSetting.Bread_Winner__Page_Layouts_Updated__c)}">
                                                                    
                                                                    <apex:outputPanel rendered="{!AND(NOT(isLayoutUpdated),isAccountSyncDone,isAdministrator)}">
                                                                        <apex:commandLink status="assign-action-status" action="{!showPageLayoutUpdateableSection}" style="color:black"  reRender="pageLayoutUpdatePanel" onclick="showLayoutEditsection();"  oncomplete="HideStyleSheet();message();">Update your Account and Opportunity Page Layouts</apex:commandLink>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel rendered="{!OR(isLayoutUpdated,NOT(isAccountSyncDone), NOT(isAdministrator), bwSetting.Bread_Winner__Page_Layouts_Updated__c)}">
                                                                        Update your Account and Opportunity Page Layouts
                                                                    </apex:outputPanel> 
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </td> 
                                                    <td style="width:4%;border-top-color: white;">
                                                        <div >
                                                            <apex:outputPanel id="pagelayoutCheck" >
                                                                <apex:outputPanel >
                                                                    <apex:image styleClass="crossIcon" value="{!IF(isLayoutUpdated, URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png') , URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png') )}" height="32" width="32"/>
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </td>  
                                                    
                                                    
                                                    <td style="border-top-color: white;">
                                                        <apex:outputPanel id="V2Section">
                                                            
                                                            <apex:outputPanel layout="block"  id="V2Pagelayouts" rendered="{!AND(isAdministrator, OldOrg)}">
                                                                <apex:commandLink styleClass="slds-text-body--small" style="color:gray;" rendered="{!AND(NOT(bwSetting.Bread_Winner__Page_Layouts_Updated__c),!unableToAddRemoteSiteSetting)}" status="assign-action-status" onclick="showLayoutEditsection();"  action="{!showV2layouts}"  reRender="V2pageLayoutUpdatePanel" oncomplete="HideStyleSheet();message();">Update Breadwinner 2.0 Page Layouts</apex:commandLink>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel styleClass="slds-text-body--small" style="color:gray;" rendered="{!unableToAddRemoteSiteSetting && NOT(bwSetting.Bread_Winner__Page_Layouts_Updated__c)}">
                                                                When you have configured your page layout, please click the toggle to mark them completed.
                                                                <div class="slds-clearfix">
                                                                    <div class="slds-form-element slds-float--left">
                                                                        <label class="slds-checkbox--toggle slds-grid">
                                                                            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="PageLayoutsStatus1" onclick='Check_PageLayoutsStatus1(this);'/>
                                                                            <span id="toggle-desc" class="slds-checkbox--faux_container" aria-live="assertive">
                                                                                <span class="slds-checkbox--faux"></span>
                                                                                <span class="slds-checkbox--on">Enabled</span>
                                                                                <span class="slds-checkbox--off">Disabled</span>
                                                                            </span>
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </apex:outputPanel>
                                                            <apex:actionFunction name="SaveUpdatePagelayouts1" action="{!SaveUpdatePagelayouts}" rerender="pageLayoutHeadingPanel,pagelayoutCheck,V2Section" status="assign-action-status" oncomplete="HideStyleSheet();message();">            
                                                                <apex:param id="LayoutSyncValue3" name="AllowLayoutsync" value="" />        
                                                            </apex:actionFunction>
                                                        </apex:outputPanel>
                                                    </td> 
                                                    
                                                </tr>
                                                <tr style="border:none;display:none;" id="showlayoutTRId" >
                                                    <td colspan="3" style="border:none;border-top:0px;">
                                                        <apex:outputPanel id="pageLayoutUpdatePanel" >
                                                            
                                                            <apex:outputPanel rendered="{!AND(isPageLayoutUpdateableSection,NOT(isLayoutUpdated))}">
                                                                
                                                                <div class="slds-box" >
                                                                    <div class="slds-text-body--small slds-m-bottom--small">
                                                                        <apex:pageMessages ></apex:pageMessages>
                                                                        
                                                                        We won't change, move, or remove any of your fields, we'll just add the Breadwinner fields. 
                                                                        You can still edit the page layouts further after we auto-update them, or manually undo or alter any changes.
                                                                    </div>
                                                                    
                                                                    <div class="slds-form-element">
                                                                        <div class="slds-form-element__control">
                                                                            <label class="slds-checkbox">
                                                                                <apex:inputCheckbox value="{!updateAccountPageLayouts}" /> 
                                                                                <span class="slds-checkbox--faux"></span>
                                                                                <span class="slds-form-element__label">
                                                                                    Update my Account Page Layout(s) with Breadwinner's Fields, Charts, and Invoice Related Lists
                                                                                </span>
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-form-element">
                                                                        <div class="slds-form-element__control">
                                                                            <label class="slds-checkbox">
                                                                                <apex:inputCheckbox value="{!updateOpportunityPageLayouts}" /> 
                                                                                <span class="slds-checkbox--faux"></span>
                                                                                <span class="slds-form-element__label">
                                                                                    Update my Opportunity Page Layout(s) with Breadwinner's Invoice Related Lists
                                                                                </span>
                                                                            </label>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-m-top--medium" >
                                                                        <apex:commandButton value="Update Automatically" styleClass="slds-button slds-button--brand" action="{!updatePageLayouts}" disabled="{!NOT(isAdministrator)}"  status="assign-action-status" rerender="progressPanel,infoPanel,pagelayoutCheck,pageLayoutUpdatePanel,pageLayoutHeadingPanel,pnl" oncomplete="HideStyleSheet();message();"/>
                                                                        <apex:outputPanel styleClass="slds-text-body--small">
                                                                            Or, alternatively, update them yourself following &nbsp;  
                                                                            <a style="color:gray" href="{!BW_SupportPortalURL}/customer/portal/articles/1607408-configure-your-page-layouts" target="_blank">our suggested Page Layout guide</a>.
                                                                        </apex:outputPanel>
                                                                        
                                                                    </div>
                                                                    
                                                                    <apex:outputpanel id="pnl">
                                                                        <apex:outputPanel rendered="{!foundException}">
                                                                            <br/><br/>
                                                                            <div class="slds-text-body--small">
                                                                                Please update your page layouts manually by following the Suggested Page Layout Guide. Once you have updated, click the toggle so you don't see this message again.
                                                                            </div>
                                                                            
                                                                            <apex:outputPanel layout="block" styleClass="slds-clearfix slds-m-top--small" rendered="{!foundException}">
                                                                                <div class="slds-form-element slds-float--left">
                                                                                    <label class="slds-checkbox--toggle slds-grid">
                                                                                        <span class="slds-form-element__label slds-m-bottom--none">I have updated my page layouts manually</span>
                                                                                        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="PageLayoutsStatus" onclick='Check_PageLayoutsStatus(this);'/>
                                                                                        <span id="toggle-descd" class="slds-checkbox--faux_container" aria-live="assertive">
                                                                                            <span class="slds-checkbox--faux"></span>
                                                                                            <span class="slds-checkbox--on">Enabled</span>
                                                                                            <span class="slds-checkbox--off">Disabled</span>
                                                                                        </span>
                                                                                    </label>
                                                                                </div>
                                                                            </apex:outputPanel>
                                                                            
                                                                        </apex:outputPanel>
                                                                        <apex:actionFunction name="SaveUpdatePagelayouts" action="{!SaveUpdatePagelayouts}" rerender="progressPanel,infoPanel,pagelayoutCheck,pageLayoutUpdatePanel,pageLayoutHeadingPanel" oncomplete="HideStyleSheet();message();">     
                                                                            <apex:param id="LayoutSyncValue2" name="AllowLayoutsync" value="" />
                                                                        </apex:actionFunction>
                                                                    </apex:outputpanel>                   
                                                                </div>
                                                            </apex:outputPanel>
                                                            
                                                        </apex:outputPanel>
                                                        
                                                        
                                                        <apex:outputPanel id="V2pageLayoutUpdatePanel" >
                                                            <apex:outputPanel rendered="{!ShowV2layoutSection }">
                                                                
                                                                <div class="slds-box">
                                                                    <div class="slds-text-body--small slds-m-bottom--small">
                                                                        <apex:pageMessages ></apex:pageMessages>
                                                                        <apex:outputpanel rendered="{!NOT(assigned_BW_PermissionSet)}" styleclass="warningM3 " style="border-radius:4px;" layout="block">
                                                                            Please assign&nbsp;<apex:outputLink styleClass="link" target="_blank" value="/{!Permissionsetid}" style="color:black;">Breadwinner Full User</apex:outputLink>&nbsp;Permission Set to allow Breadwinner to update your page layouts smoothly. 
                                                                        
                                                                        </apex:outputpanel>
                                                                        We won't change, move, or remove any of your fields, we'll just add the Breadwinner fields. 
                                                                        You can still edit the page layouts further after we auto-update them, or manually undo or alter any changes.
                                                                    </div>
                                                                    
                                                                    <div class="slds-m-top--medium" >
                                                                        <apex:commandButton value="Update 2.0 Layouts" styleClass="slds-button slds-button--brand" action="{!updateV2PageLayouts}" disabled="{!NOT(isAdministrator)}" reRender="V2pageLayoutUpdatePanel, V2Section, pagelayoutCheck" status="assign-action-status" oncomplete="HideStyleSheet();message();" />
                                                                        <apex:outputPanel styleClass="slds-text-body--small slds-m-left--small">
                                                                            Or, alternatively, update them yourself following &nbsp;  
                                                                            <a href="{!BW_SupportPortalURL}/customer/en/portal/articles/2512582-new-tabs-and-fields-for-breadwinner-2-0" target="_blank">our suggested Page Layout guide</a>.
                                                                        </apex:outputPanel>
                                                                        
                                                                        <apex:outputPanel rendered="{!foundException}">
                                                                            <br/><br/>
                                                                            
                                                                            <div class="slds-text-body--small">
                                                                                Please update your page layouts manually by following the Suggested Page Layout Guide for Breadwinner 2.0. Once you have updated, click the toggle so you don't see this message again.
                                                                            </div>
                                                                            
                                                                            <!------ adding for manual update --->
                                                                            <apex:outputPanel layout="block" styleClass="slds-clearfix slds-m-top--small" rendered="{!foundException}">
                                                                                <div class="slds-form-element slds-float--left">
                                                                                <label class="slds-checkbox--toggle slds-grid">
                                                                                    <span class="slds-form-element__label slds-m-bottom--none">I have updated my page layouts manually</span>
                                                                                    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="PageLayoutsStatus" onclick='Check_PageLayoutsStatus(this);'/>
                                                                                    <span id="toggle-desc" class="slds-checkbox--faux_container" aria-live="assertive">
                                                                                        <span class="slds-checkbox--faux"></span>
                                                                                        <span class="slds-checkbox--on">Enabled</span>
                                                                                        <span class="slds-checkbox--off">Disabled</span>
                                                                                    </span>
                                                                                </label>
                                                                                </div>
                                                                            </apex:outputPanel>
                                                                            
                                                                        </apex:outputPanel>
                                                                        <apex:actionFunction name="SaveUpdatePagelayouts" action="{!SaveUpdatePagelayouts}" rerender="SynView,V2pageLayoutUpdatePanel, V2Pagelayouts,pageLayoutHeadingPanel,pagelayoutCheck,V2Section,pageLayoutUpdatePanel" oncomplete="HideStyleSheet();message();">     
                                                                            <apex:param id="LayoutSyncValue" name="AllowLayoutsync" value="" />
                                                                        </apex:actionFunction>
                                                                        
                                                                    </div>
                                                                </div>  
                                                                
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>  
                                                        <div class="slds-text-heading--medium" >
                                                            Subscribe to Breadwinner                                                                   
                                                        </div>
                                                    </td> 
                                                    <td>
                                                        <div class="textDiv" >
                                                        <apex:outputPanel rendered="{!NOT(OR(isSandbox, isDeveloperEdition))}">
                                                            <apex:image styleClass="crossIcon"   value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/green_check.png')}" rendered="{!IF(orgStatus =='subscribed', true, false)}"/>
                                                            <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/yellow_check.png')}" rendered="{!IF(orgStatus =='trial', true, false)}"/>                              
                                                            <apex:image styleClass="crossIcon"  value="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/red_check.png')}" rendered="{!IF(orgStatus =='expired', true, false)}"/>                                                             
                                                        </apex:outputPanel>
                                                        </div>
                                                    </td>  
                                                    <td></td>     
                                                </tr>
                                                <tr >
                                                    <td style="border:none; margin-top:0px;" class="slds-text-body--small" colspan="3">
                                                        
                                                        <apex:outputPanel rendered="{!IF(orgStatus =='subscribed', true, false)}">
                                                            Your subscription to Breadwinner is Active.
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!IF(orgStatus =='trial', true, false)}">
                                                            <apex:outputPanel rendered="{!AND(NOT(isSandbox), NOT(isDeveloperEdition))}">
                                                                To guarantee continued access, subscribe to Breadwinner before <br/>
                                                                your trial expires in {!noOfDaysLeft} days. We will email you with more information.
                                                                <br/>
                                                                <a style="color:gray" href="https://support.breadwinnerhq.com/payment/{!$Organization.Id}" target="_blank">Click here to Subscribe to Breadwinner</a>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!isSandbox}">
                                                                This is running in a Sandbox. Because payment is tied to the instance where Breadwinner is installed, you can only pay for Breadwinner from a production org, not a Sandbox.<br/>
                                                                If this was a Salesforce Production org, you would be given the option to pay here.
                                                                <br/> <br/>
                                                                If you need to extend your free trial, which will expire in {!noOfDaysLeft} days, please click Contact Support to the left and file a case requesting a 2 week extension of your Sandbox trial.
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!isDeveloperEdition}">
                                                            You cannot subscribe on a Developer Org.<br/>
                                                            However, you can request an extension of your free trial{!IF(orgStatus =='expired','',', which expires in '+Text(noOfDaysLeft)+' days,')}&nbsp;by&nbsp;<apex:outputLink onclick="OpenContactSupportTab();loadIframesfun('Contact_SupportPage','{!BW_SupportPortalURL}/customer/portal/emails/new?t=711718');" value="javascript:void(0);">contacting Breadwinner Support</apex:outputLink>
                                                            <br/>Please mention that your Org ID is {!$Organization.Id}
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!IF(orgStatus =='expired', true, false)}">
                                                            <apex:outputPanel rendered="{!AND(NOT(isSandbox), NOT(isDeveloperEdition))}">
                                                                You don't have an active subscription to Breadwinner.<br/>
                                                                <br/>
                                                                <a href="https://support.breadwinnerhq.com/payment/{!$Organization.Id}" target="_blank">Click here to Subscribe to Breadwinner</a>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{!isSandbox}">
                                                                This is a Sandbox Salesforce org, and you cannot pay for Breadwinner in a Sandbox, only in a Production Org.
                                                                <br/>
                                                                However, if you need to extend your free trial, please file a case using the Contact Support section on the left, requesting a trial extension, and please quote Org ID <b>{!$Organization.Id}</b>.
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </td>
                                                </tr>
                                            </table>
                                            
                                            <div class="slds-m-top--medium">
                                                
                                                <div class="slds-grid slds-wrap">
                                                    <div class="slds-size--1-of-1 slds-medium-size--3-of-6 slds-large-size--6-of-12">
                                                        <apex:commandLink action="{!showEditSettingSection}" rendered="{!isAdministrator}" status="assign-action-status" rerender="SettingSectionPanel" oncomplete="scrolltoBottom();">.
                                                        </apex:commandLink>
                                                        <apex:outputPanel layout="block" id="SettingSectionPanel">
                                                            <apex:outputPanel layout="block" styleClass="slds-box slds-float--left" rendered="{!isEditSettingSection}">
                                                                <div>
                                                                    <label class="slds-checkbox">
                                                                        <span class="slds-form-element__label">
                                                                            {!$ObjectType.Breadwinner_Settings__c.Fields.Multi_Org_Enabled__c.Label}
                                                                        </span>
                                                                        <apex:inputField value="{!bwSetting.Bread_Winner__Multi_Org_Enabled__c}" /> 
                                                                        <span class="slds-checkbox--faux"></span>
                                                                    </label>
                                                                </div>
                                                                <div class="slds-m-top--small">
                                                                    <apex:commandButton value="Save" styleClass="slds-button slds-button--brand" action="{!saveSettingSection}" status="assign-action-status" />
                                                                    
                                                                    <apex:commandButton value="Cancel" styleClass="slds-button slds-button--neutral" action="{!cancelSettingSection}"  status="assign-action-status"/>
                                                                </div>
                                                            </apex:outputPanel>
                                                            
                                                        </apex:outputPanel> 
                                                    </div>
                                                    <div class="slds-size--1-of-1 slds-medium-size--3-of-6 slds-large-size--6-of-12" align="right">
                                                        <apex:commandLink value="Connection to Xero Options" rendered="{!NOT(isConsumerDetailFilled)}" action="{!showPopup}" style="font-size:12px;color:grey;" status="assign-action-status" reRender="tstpopup"/>
                                                        &nbsp;
                                                        <apex:commandLink action="{!showEndpointUrlEditor}" rendered="{!NOT(isConsumerDetailFilled)}" style="color:gray" status="assign-action-status" rerender="SettingURL">.
                                                        </apex:commandLink>
                                                        
                                                        <apex:outputPanel id="SettingURL">
                                                            <apex:outputPanel layout="block" styleClass="slds-box slds-float--right" rendered="{!showEndpointURLSetting}">
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label" >{!$ObjectType.Breadwinner_Settings__c.Fields.Endpoint_URL_Override__c.Label}</label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:selectList value="{!bwSetting.Bread_Winner__Endpoint_URL_Override__c}" size="1" styleClass="slds-input">
                                                                            <apex:selectOptions value="{!AvailableEndpointURLs}">
                                                                            </apex:selectOptions>
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                                <div class="slds-m-top--small">
                                                                    <apex:commandButton value="Save & Create Remotesite" styleClass="slds-button slds-button--brand" action="{!saveAndCreateRemoteSite}" status="assign-action-status" rendered="{!unableToAddRemoteSiteSetting}"/>
                                                                    <apex:commandButton value="Save" styleClass="slds-button slds-button--brand" action="{!updateEndpointUrlOverride}" status="assign-action-status"/>
                                                                    <apex:commandButton value="Cancel" styleClass="slds-button slds-button--neutral" action="{!hideEndpointUrlEditor}" reRender="SettingURL" status="assign-action-status"/>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                
                                            </div>
                                        </div>
                                        
                                        
                                        
                                        
                                    </div>
                                    <div id="SetupAndConfig-TAB2" class="slds-hide" aria-labelledby="InvoiceContent">
                                        <!-- <apex:outputPanel id="Invoiceconfigsection">
                                            <apex:variable value="BreadwinnerOptionalSettings" var="BreadwinnerOptionalSettingsURL"/>
                                            <apex:iframe src="{!BreadwinnerOptionalSettingsURL}" height="700px" frameborder="false" scrolling="true" />
                                        </apex:outputPanel> -->
                                    </div>
                                    <div id="SetupAndConfig-TAB3" class="slds-hide" aria-labelledby="BillsContent">
                                        
                                        <apex:outputPanel layout="block" rendered="{!AND(isBusinessOrHigher,listAppConfig.size>0, isAdministrator)}">
                                            <div class="slds-page-header slds-m-bottom--medium" role="banner">
                                                <div class="slds-media">
                                                    <div class="slds-media__figure">
                                                        <svg aria-hidden="true" class="slds-icon slds-icon-standard-opportunity">
                                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/standard-sprite/svg/symbols.svg#custom')}"></use>
                                                        </svg>
                                                    </div>
                                                    <div class="slds-media__body">
                                                        <p class="slds-page-header__title slds-truncate" title="Bills Configuration">Bills Configuration</p>
                                                        <p class="slds-text-body--small">Breadwinner â€¢ Xero </p>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <apex:actionFunction name="BillPassXeroOrgId" action="{!MultiOrgChanging}" status="assign-action-status"  reRender="BillPgMsg,BillsWholePanel" oncomplete="HideStyleSheet();message();" >
                                                <apex:param name="BillPassXeroOrgIdParam" value="" assignTo="{!SelectedOrg}"/>
                                            </apex:actionFunction>
                                            <apex:outputPanel id="BillsMenuFieldsSectionId" >
                                            <!-- ---------------------- Bills Menu Starts Here ------------------- -->
                                            
                                            <apex:outputPanel layout="block" id="BillMenuId" rendered="{!isMultiOrgEnabled}">
                                                <ul class="slds-tabs--default__nav slds-m-bottom--large" role="tablist">
                                                    
                                                    <li class="slds-tabs--default__item slds-text-title--caps slds-active slds-truncate" title="Bredwinner Wide Settings" role="presentation">
                                                        <a class="slds-tabs--default__link"  role="tab" onclick=" SubTabsSelect(this, '','Bill');" tabindex="0" aria-selected="true" aria-controls="tab-default-1" id="tab-default-1__item">
                                                            Breadwinner Wide Settings
                                                        </a>
                                                    </li>
                                                    
                                                    <apex:repeat value="{!appConfigMap}" var="appC">
                                                        
                                                        <li class="slds-tabs--default__item slds-text-title--caps slds-truncate" title="{!appConfigMap[appC].Connecting_App_Name__c}" role="presentation">
                                                            <a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" onclick=" SubTabsSelect(this, '{!appConfigMap[appC].Xero_Org_ID__c}','Bill'); " tabindex="0" aria-selected="true" aria-controls="{!appConfigMap[appC].Xero_Org_ID__c}" id="{!appConfigMap[appC].Xero_Org_ID__c}__item">
                                                                {!appConfigMap[appC].Connecting_App_Name__c}
                                                            </a>
                                                        </li>
                                                    </apex:repeat>
                                                    
                                                </ul>
                                                
                                            </apex:outputPanel>
                                            <!-- ---------------------- Bills Menu ends Here ------------------- -->
                                            <apex:pageMessages id="BillPgMsg"></apex:pageMessages>
                                            <apex:outputPanel layout="block" id="BillsWholePanel" rendered="{!BillsORPo=='Bill'}">
                                                
                                                    <apex:outputPanel layout="block" styleclass=" slds-m-left--large slds-m-bottom--large" rendered="{!OR(AND(isMultiOrgEnabled,SelectedOrg!=null),NOT(isMultiOrgEnabled))}">
                                                        <div class="slds-clearfix">
                                                        <div class="slds-form-element slds-m-top--medium slds-float--left">
                                                            <label class="slds-checkbox--toggle slds-grid">
                                                                <span class="slds-form-element__label slds-m-bottom--none">Enable Bills Sync
                                                                    <apex:outputPanel styleClass="slds-form-element__icon" >
                                                                        <a href="javascript:void(0);">
                                                                            <apex:image style="margin-left: 5px;margin-bottom: 4px;height:15px;width:15px;" url="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/InfoLightning.png')}" onmouseover="identifyfield(this,'You might also know Vendors as Suppliers. ','147','27')" onmouseout="mouseoutclose();" rendered="{!NOT(OR($User.UIThemeDisplayed == 'Theme4d', $User.UIThemeDisplayed == 'Theme4t'))}" />
                                                                            <apex:image style="margin-left: 5px;margin-bottom: 4px;height:15px;width:15px;" url="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/InfoLightning.png')}" onmouseover="identifyfield(this,'You might also know Vendors as Suppliers. ','45','17')" onmouseout="mouseoutclose();" rendered="{!OR($User.UIThemeDisplayed == 'Theme4d', $User.UIThemeDisplayed == 'Theme4t')}"/>
                                                                            <span class="slds-assistive-text">Help</span>
                                                                        </a>
                                                                    </apex:outputPanel> 
                                                                    
                                                                </span>
                                                                <apex:inputCheckbox value="{!apcBPTab.Bread_Winner__Sync_Suppliers_Bills__c}" onclick="BillsOnOffFunctionapexBPTab(this.checked);" />
                                                                <span class="slds-checkbox--faux_container" aria-live="assertive">
                                                                    <span class="slds-checkbox--faux"></span>
                                                                    <span class="slds-checkbox--on">Enabled</span>
                                                                    <span class="slds-checkbox--off">Disabled</span>
                                                                </span>
                                                            </label>
                                                        </div>
                                                        </div>
                                                        <apex:outputPanel layout="block" styleClass="infoM3 slds-m-top--small" style="border-radius:4px;" rendered="{!AND(NOT(apcBPTab.Bread_Winner__Is_Supplier_Sync_Completed__c) , apcBPTab.Bread_Winner__Sync_Suppliers_Bills__c, isBusinessOrHigher)}">
                                                            Please finish Suppliers sync from Setup tab
                                                        </apex:outputPanel>
                                                        
                                                    </apex:outputPanel>
                                                <apex:outputPanel layout="block" rendered="{!isBillsEnabled}">
                                                    <!-- -------------------- Xero Org wide Bills settings starts here --------------------- -->
                                                    <apex:outputPanel layout="block" rendered="{!AND(apcBPTab.Bread_Winner__Sync_Suppliers_Bills__c,OR(AND(isMultiOrgEnabled,SelectedOrg!=null),NOT(isMultiOrgEnabled)))}">
                                                        <div class="slds-m-horizontal--small">
                                                        
                                                        <div class="slds-section-title--divider slds-m-top--medium">Allow Bills to be created as Draft/Approved</div>
                                                            <div class="slds-text-body--small slds-m-top--x-small slds-m-left--small">
                                                                <p>At least one or more of the two checkboxes must be checked. This will allow Breadwinner users to create Bill as Draft or Authorized</p>
                                                            </div>
                                                            <div class="slds-m-left--small slds-form-element">
                                                                
                                                                <div class="slds-form-element__control slds-m-top--x-small">
                                                                    <span class="slds-checkbox">
                                                                        <label class="slds-checkbox__label" >
                                                                            <apex:inputCheckbox value="{!apcBPTab.Bread_Winner__Create_Draft_Bill__c}"/>
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label slds-m-left--small">Show "Create Draft Bill in Xero" Button</span>
                                                                        </label>
                                                                    </span>
                                                                    <span class="slds-checkbox">
                                                                        <label class="slds-checkbox__label" >
                                                                            <apex:inputCheckbox value="{!apcBPTab.Bread_Winner__Create_Approved_Bill__c}" />
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label slds-m-left--small">Show "Create Approved Bill in Xero" Buttons</span>
                                                                        </label>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="slds-section-title--divider slds-m-top--medium">Bills Default Accounting Code</div>
                                                            <div class="slds-m-left--small slds-m-top--small">
                                                                
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label" >Default Xero Accounting Payable Tax Type</label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:selectList size="1" value="{!apcBPTab.Bread_Winner__Default_Xero_Payable_Tax_Type__c}" styleClass="slds-input slds-size--1-of-1 slds-medium-size--2-of-6 slds-large-size--3-of-12">
                                                                            <apex:selectOptions value="{!defaultXeroTaxOptions}"/>
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                                
                                                                <apex:actionFunction name="GetBillAccountCodes" rerender="AccountCodes,AccountCode" action="{!BillsRevenuevisibility}"/>
                                                                <apex:outputPanel id="AccountCodes" layout="block" styleclass="slds-form-element slds-m-top--medium">
                                                                    <label class="slds-form-element__label" >Default Xero Payable Accounting Code (Revenue Code)</label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:selectList size="1" value="{!apcBPTab.Bread_Winner__Default_Xero_Payable_Accounting_Code__c}" id="AccountCode" styleClass="slds-input slds-size--1-of-1 slds-medium-size--2-of-6 slds-large-size--3-of-12" rendered="{!if(defaultXeroAccountingOptions.size>1, true, false)}">
                                                                            <apex:selectOptions value="{!defaultXeroAccountingOptions}"/>
                                                                        </apex:selectList>
                                                                        <apex:outputPanel layout="block" styleClass="slds-m-left--small slds-m-top--xx-small" rendered="{!if(defaultXeroAccountingOptions.size>1, false, true)}">
                                                                            No Revenue Codes showing? &nbsp;<apex:commandLink action="{!refreshXeroAccountingDetails}" reRender="AccountCodes" status="assign-action-status" oncomplete="HideStyleSheet();message();BillRerenderAccountCodes();">Refresh them from Xero</apex:commandLink>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </apex:outputPanel>
                                                                
                                                                <apex:outputPanel layout="block" id="BillAccountCodes">
                                                                    <div class="slds-form-element slds-m-top--medium ">
                                                                        <span class="slds-checkbox">
                                                                            <label class="slds-checkbox__label" >
                                                                                <apex:inputCheckbox value="{!Display_Revenue_Accounts}" onchange="GetBillAccountCodes();"/>
                                                                                <span class="slds-checkbox--faux"></span>
                                                                                <span class="slds-form-element__label slds-m-right--small">Display Liabilities and Revenue Accounts on New Bill creation Page</span>
                                                                            </label>
                                                                        </span>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        
                                                    </apex:outputPanel>
                                                    <!-- -------------------- Xero Org wide Bills settings ends here ----------------------- -->
                                                    
                                                    <!-- -------------------- Breadwinner wide Bills settings starts here------------------- -->
                                                    <apex:outputPanel rendered="{!OR(AND(isMultiOrgEnabled,SelectedOrg==null),NOT(isMultiOrgEnabled))}" >
                                                        <!-- Multi org help Text -->
                                                        <apex:outputPanel layout="block" styleclass="slds-text-heading--small slds-m-horizontal--small" style="font-style: italic;" rendered="{!isMultiOrgEnabled}">
                                                            As you are using Breadwinner with Multiple Xero Orgs, we have split the Configuration section into multiple pages. This page is for settings that affect all of Breadwinner regardless of which Xero org. The other pages are for settings that affect just one of your many Xero orgs.
                                                        </apex:outputPanel>
                                                        <div class="slds-m-horizontal--small slds-m-top--medium">
                                                            <div class="slds-section-title--divider"> Bill Default Fields</div>
                                                            <div class="slds-grid slds-wrap slds-m-left--small">
                                                                
                                                                <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 ">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Reference</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opportunity_Reference__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppTextFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Date</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opportunity_Date__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppDateFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                                
                                                                <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Due Date</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opportunity_Due_Date__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppDateFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Branding Theme</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opportunity_Branding_Theme__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppTextFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                                
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="slds-m-horizontal--small slds-m-top--medium">
                                                            <div class="slds-section-title--divider"> Bill Default Line Item Fields</div>
                                                            <div class="slds-grid slds-wrap slds-m-left--small">
                                                                
                                                                <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 ">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Supplier Account</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Default_Bill_Supplier_Account__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOSupplierAccountFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Line Item Supplier Price</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opportunity_Line_Item_Price__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOSupplierPriceFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Line Item Quantity</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opportunity_Line_Item_Quantity__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOSupplierPriceFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Line Item Inventory Code</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opp_Line_Item_InventoryCode__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Line Item Description
                                                                            <apex:outputPanel styleClass="slds-form-element__icon" >
                                                                                <a href="javascript:void(0);">
                                                                                    <img style="margin-left: 5px;margin-bottom: 2px;height:15px;width:15px;" src="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/InfoLightning.png')}" onmouseover="identifyfield(this,'You can not select a Long Text Area field here due to Xero Limitations.','165','25')" onmouseout="mouseoutclose();" />
                                                                                    <span class="slds-assistive-text">Help</span>
                                                                                </a>
                                                                            </apex:outputPanel>
                                                                            </label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opportunity_Line_Item_Description__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Line Item Account Revenue</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opp_Line_Item_Account_Revenue__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Line Item Tax Rate</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opportunity_Line_Item_TaxRate__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Line Item Tracking Category 1</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opp_Line_Item_Tracking_Category1__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Bill Line Item Tracking Category 2</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Bill_Opp_Line_Item_Tracking_Category2__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                                
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    
                                                    <!-- -------------------- Breadwinner wide Bills settings ends here -------------------- -->
                                                    
                                                    <div class="slds-m-top--medium slds-m-bottom--medium" align="center">
                                                       <!-- <apex:commandLink value="Save and Proceed to Suppliers Sync" action="{!saveBPConfigs}" styleClass="slds-button slds-button--brand" reRender="BillPgMsg,BillsWholePanel" rendered="{!AND(NOT(apcBPTab.Is_Supplier_Sync_Completed__c==false) , apcBPTab.Sync_Suppliers_Bills__c)}" oncomplete="HideStyleSheet();message();" /> -->
                                                        <apex:commandLink value="Save" action="{!saveBPConfigs}" status="assign-action-status" styleClass="slds-button slds-button--brand" reRender="BillPgMsg,BillsWholePanel" oncomplete="HideStyleSheet();message();scrolltoTop();" rendered="{!AND(OR(AND(isMultiOrgEnabled,SelectedOrg!=null,apcBPTab.Bread_Winner__Sync_Suppliers_Bills__c),AND(isMultiOrgEnabled,SelectedOrg==null),NOT(isMultiOrgEnabled)))}"/>
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:pagemessage severity="Info" summary="Please Enable Bills! " rendered="{!AND(isBillsEnabled==false,SelectedOrg==null,isMultiOrgEnabled)}" ></apex:pagemessage>
                                            </apex:outputPanel>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        
                                        <apex:actionFunction name="BillsOnOffFunctionapexBPTab" action="{!allowBillsPOsSync}" status="assign-action-status" rerender="BillsWholePanel,SynView,MutliOrgAccountSyncView,accountSyncPanel,DefaultBillAccCodes1,DefaultBillAccCodes,BillPgMsg"  oncomplete="HideStyleSheet();message();BillRerenderAccountCodes();">             
                                            <apex:param id="BillsValue" name="AllowBillssync" value="" />        
                                        </apex:actionFunction>
                                        <apex:actionFunction name="BillRerenderAccountCodes1"  rerender="AccountCodes" oncomplete="HideStyleSheet();message();" >             
                                        </apex:actionFunction>
                                        <script>
                                        function BillRerenderAccountCodes(){
                                            window.setTimeout(BillRerenderAccountCodes1,10000)
                                        }
                                        </script>
                                        
                                    </div>
                                    <div id="SetupAndConfig-TAB4" class="slds-hide" aria-labelledby="POsContent">
                                        
                                        <apex:outputPanel layout="block"  rendered="{!AND(isBusinessOrHigher,listAppConfig.size>0, isAdministrator)}">
                                            <div class="slds-page-header slds-m-bottom--medium" role="banner">
                                                <div class="slds-media">
                                                    <div class="slds-media__figure">
                                                        <svg aria-hidden="true" class="slds-icon slds-icon-standard-opportunity">
                                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/standard-sprite/svg/symbols.svg#custom')}"></use>
                                                        </svg>
                                                    </div>
                                                    <div class="slds-media__body">
                                                        <p class="slds-page-header__title slds-truncate" title="Purchase Orders Configuration">Purchase Orders Configuration</p>
                                                        <p class="slds-text-body--small">Breadwinner â€¢ Xero </p>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <apex:actionFunction name="PoPassXeroOrgId" action="{!MultiOrgChanging}" status="assign-action-status"  reRender="PoPgMsg,PosWholePanel" oncomplete="HideStyleSheet();message();" >
                                                <apex:param name="POPassXeroOrgIdParam" value="" assignTo="{!SelectedOrg}"/>
                                            </apex:actionFunction>
                                            <apex:outputPanel id="PoMenuFieldsSectionId" >
                                            <!-- ---------------------- Pos Menu Starts Here ------------------- -->
                                            
                                            <apex:outputPanel id="PoMenuId" rendered="{!isMultiOrgEnabled}">
                                                <ul class="slds-tabs--default__nav slds-m-bottom--large" role="tablist">
                                                    
                                                    <li class="slds-tabs--default__item slds-text-title--caps slds-active slds-truncate" title="Bredwinner Wide Settings" role="presentation">
                                                        <a class="slds-tabs--default__link"  role="tab" onclick=" SubTabsSelect(this, '','Po');" tabindex="0" aria-selected="true" aria-controls="tab-default-1" id="tab-default-1__item">
                                                            Breadwinner Wide Settings
                                                        </a>
                                                    </li>
                                                    
                                                    <apex:repeat value="{!appConfigMap}" var="appC">
                                                        
                                                        <li class="slds-tabs--default__item slds-text-title--caps slds-truncate" title="{!appConfigMap[appC].Connecting_App_Name__c}" role="presentation">
                                                            <a class="slds-tabs--default__link" href="javascript:void(0);" role="tab" onclick=" SubTabsSelect(this, '{!appConfigMap[appC].Xero_Org_ID__c}','Po'); " tabindex="0" aria-selected="true" aria-controls="{!appConfigMap[appC].Xero_Org_ID__c}" id="{!appConfigMap[appC].Xero_Org_ID__c}__item">
                                                                {!appConfigMap[appC].Connecting_App_Name__c}
                                                            </a>
                                                        </li>
                                                    </apex:repeat>
                                                    
                                                </ul>
                                                
                                            </apex:outputPanel>
                                            <!-- ---------------------- Pos Menu ends Here ------------------- -->
                                            <apex:pageMessages id="PoPgMsg"></apex:pageMessages>
                                            <apex:outputPanel id="PosWholePanel" rendered="{!BillsORPo=='PO'}">
                                                
                                                <apex:outputPanel layout="block" styleclass="slds-m-left--large  slds-m-top--medium slds-m-bottom--large" rendered="{!OR(AND(isMultiOrgEnabled,SelectedOrg!=null),NOT(isMultiOrgEnabled))}">
                                                    <div class="slds-clearfix">
                                                        <div class="slds-form-element slds-float--left ">
                                                            <label class="slds-checkbox--toggle slds-grid ">
                                                                <span class="slds-form-element__label slds-m-bottom--none">Enable Purchase Orders Sync</span>
                                                                <apex:inputCheckbox value="{!apcBPTab.Bread_Winner__Sync_POs__c}"  onclick="POsOnOffFunctionapexBPTab(this.checked);" />
                                                                <span class="slds-checkbox--faux_container" aria-live="assertive">
                                                                    <span class="slds-checkbox--faux"></span>
                                                                    <span class="slds-checkbox--on">Enabled</span>
                                                                    <span class="slds-checkbox--off">Disabled</span>
                                                                </span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                    <apex:outputPanel layout="block" styleClass="infoM3 slds-m-top--small" style="border-radius:4px;" rendered="{!AND(NOT(apcBPTab.Bread_Winner__Is_PO_Contact_Sync_Completed__c) , apcBPTab.Bread_Winner__Sync_POs__c, isBusinessOrHigher)}">
                                                        Please finish Xero Contacts with Purchase Orders sync from Setup tab
                                                    </apex:outputPanel>
                                                    
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!isPosEnabled}">
                                                    <!-- -------------------- Xero Org wide Pos settings starts here --------------------- -->
                                                    <apex:outputPanel layout="block" rendered="{!AND(apcBPTab.Bread_Winner__Sync_POs__c,OR(AND(isMultiOrgEnabled,SelectedOrg!=null),NOT(isMultiOrgEnabled)))}">
                                                        <div class="slds-m-horizontal--small">
                                                            
                                                        <div class="slds-section-title--divider slds-m-top--medium">Allow Purchase Order to be created as Draft/Approved</div>
                                                            <div class="slds-text-body--small slds-m-top--x-small slds-m-left--small">
                                                                <p>At least one or more of the two checkboxes must be checked. This will allow Breadwinner users to create Purchase Order as Draft or Authorized</p>
                                                            </div>
                                                            <div class="slds-m-left--small">                                                                
                                                                <div class="slds-form-element__control slds-m-top--x-small">
                                                                    <span class="slds-checkbox">
                                                                        <label class="slds-checkbox__label" >
                                                                            <apex:inputCheckbox value="{!apcBPTab.Bread_Winner__Create_Draft_PO__c}"/>
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label slds-m-left--small">Show "Create Draft Purchase Order in Xero" Button</span>
                                                                        </label>
                                                                    </span>
                                                                    <span class="slds-checkbox">
                                                                        <label class="slds-checkbox__label" >
                                                                            <apex:inputCheckbox value="{!apcBPTab.Bread_Winner__Create_Approved_PO__c}" />
                                                                            <span class="slds-checkbox--faux"></span>
                                                                            <span class="slds-form-element__label slds-m-left--small">Show "Create Approved Purchase Order in Xero" Buttons</span>
                                                                        </label>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="slds-section-title--divider slds-m-top--medium">Purchase Order Default Accounting Code</div>
                                                            <div class="slds-m-left--small slds-m-top--small">
                                                                
                                                                <div class="slds-form-element">
                                                                    <label class="slds-form-element__label" >Default Xero Purchase Order Tax Type</label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:selectList size="1" value="{!apcBPTab.Bread_Winner__Default_Xero_PO_Tax_Type__c}" styleClass="slds-input slds-size--1-of-1 slds-medium-size--2-of-6 slds-large-size--3-of-12">
                                                                            <apex:selectOptions value="{!defaultXeroTaxOptions}"/>
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                                
                                                                <apex:actionFunction name="GetAccountCodes" rerender="POsAccountCodes,POAccountCodes,POAccountCode"  action="{!POsRevenuevisibility}"/>
                                                                <apex:outputPanel id="POsAccountCodes" layout="block" styleclass="slds-form-element slds-m-top--medium">
                                                                    <label class="slds-form-element__label" >Default Xero Purchase Order Accounting Code (Revenue Code)</label>
                                                                    <div class="slds-form-element__control">
                                                                        <apex:selectList size="1" value="{!apcBPTab.Bread_Winner__Default_Xero_PO_Accounting_Code__c}" id="POAccountCode" styleClass="slds-input slds-size--1-of-1 slds-medium-size--2-of-6 slds-large-size--3-of-12" rendered="{!if(defaultXeroAccountingOptions.size>1, true, false)}">
                                                                            <apex:selectOptions value="{!defaultXeroAccountingOptions}"/>
                                                                        </apex:selectList>
                                                                        <apex:outputPanel layout="block" styleClass="slds-m-left--small slds-m-top--xx-small" rendered="{!if(defaultXeroAccountingOptions.size>1, false, true)}">
                                                                            No Revenue Codes showing? &nbsp;<apex:commandLink action="{!refreshXeroAccountingDetails}" reRender="POsAccountCodes" status="assign-action-status" oncomplete="HideStyleSheet();message();RerenderAccountCodes();">Refresh them from Xero</apex:commandLink>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </apex:outputPanel>
                                                                
                                                                <apex:outputPanel layout="block" id="POAccountCodes">
                                                                    <div class="slds-form-element slds-m-top--medium ">
                                                                        <span class="slds-checkbox">
                                                                            <label class="slds-checkbox__label" >
                                                                                <apex:inputCheckbox value="{!DisplayPO_Revenue_Accounts}" onchange="GetAccountCodes();"/>
                                                                                <span class="slds-checkbox--faux"></span>
                                                                                <span class="slds-form-element__label slds-m-right--small">Display Liabilities and Revenue Accounts on New PO creation Page</span>
                                                                            </label>
                                                                        </span>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        
                                                    </apex:outputPanel>
                                                    <!-- -------------------- Xero Org wide Pos settings ends here ----------------------- -->
                                                    
                                                    <!-- -------------------- Breadwinner wide Pos settings starts here------------------- -->
                                                    <apex:outputPanel rendered="{!OR(AND(isMultiOrgEnabled,SelectedOrg==null),NOT(isMultiOrgEnabled))}" >
                                                        <!-- Multi org help Text -->
                                                        <apex:outputPanel layout="block" styleclass="slds-text-heading--small slds-m-horizontal--small" style="font-style: italic;" rendered="{!isMultiOrgEnabled}">
                                                            As you are using Breadwinner with Multiple Xero Orgs, we have split the Configuration section into multiple pages. This page is for settings that affect all of Breadwinner regardless of which Xero org. The other pages are for settings that affect just one of your many Xero orgs.
                                                        </apex:outputPanel>
                                                        <div class="slds-m-horizontal--small slds-m-top--medium">
                                                            <div class="slds-section-title--divider"> Purchase Order Default Fields</div>
                                                            <div class="slds-grid slds-wrap slds-m-left--small">
                                                                
                                                                <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 ">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Reference</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Reference__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppTextFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Date</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Date__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppDateFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Delivery Date</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Delivery_Date__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppDateFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Branding Theme</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Branding_Theme__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppTextFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                                
                                                                <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Delivery Address</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Delivery_Address__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppTextFields}"/>    
                                                                                    <apex:SelectOptions Value="{!POShippingAddressOptions}"/>
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Attention</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Attention__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppTextFields}"/>    
                                                                                    <apex:selectoptions value="{!POAttentionToOptions}"/>
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Telephone</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Telephone__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppTextFields}"/>    
                                                                                    <apex:selectOptions value="{!POTelephoneOptions}"/>  
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Delivery Instructions</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Delivery_Instructions__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOOppTextFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                                
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="slds-m-horizontal--small slds-m-top--medium">
                                                            <div class="slds-section-title--divider"> Purchase Order Default Line Item Fields</div>
                                                            <div class="slds-grid slds-wrap slds-m-left--small">
                                                                
                                                                <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 ">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Supplier Account</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__Default_PO_Supplier_Account__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOSupplierAccountFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Supplier Price</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Line_Item_Price__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOSupplierPriceFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Quantity</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Line_Item_Quantity__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOSupplierPriceFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Inventory Code</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opp_Line_Item_InventoryCode__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Description
                                                                            <apex:outputPanel styleClass="slds-form-element__icon" >
                                                                                <a href="javascript:void(0);">
                                                                                    <img style="margin-left: 5px;margin-bottom: 2px;height:15px;width:15px;" src="{!URLFOR($Resource.Bread_Winner__Breadwinner_Xero, 'Breadwinner_Xero/Images/InfoLightning.png')}" onmouseover="identifyfield(this,'You can not select a Long Text Area field here due to Xero Limitations.','165','25')" onmouseout="mouseoutclose();" />
                                                                                    <span class="slds-assistive-text">Help</span>
                                                                                </a>
                                                                            </apex:outputPanel>
                                                                            </label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Line_Item_Description__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2">
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Discount</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Line_Item_Discount__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOSupplierPricePercentFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Account Revenue</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opp_Line_Item_Account_Revenue__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Tax Rate</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opportunity_Line_Item_TaxRate__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Tracking Category 1</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opp_Line_Item_Tracking_Category1__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="slds-size--1-of-1 slds-medium-size--1-of-2 slds-large-size--1-of-2 slds-m-top--small">
                                                                        <div class="slds-form-element">
                                                                            <label class="slds-form-element__label" >Purchase Order Line Item Tracking Category 2</label>
                                                                            <div class="slds-form-element__control">
                                                                                <apex:selectList value="{!bwSetting.Bread_Winner__PO_Opp_Line_Item_Tracking_Category2__c}" size="1" styleClass="slds-input">
                                                                                    <apex:selectOptions value="{!BillPOStringFields}"/>    
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                                
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                    
                                                    <!-- -------------------- Breadwinner wide Pos settings ends here -------------------- -->
                                                    
                                                    <div class="slds-m-top--medium slds-m-bottom--medium" align="center">
                                                        <!-- apex:commandLink value="Save and Proceed to Suppliers Sync" action="{!saveBPConfigs}" styleClass="slds-button slds-button--brand" reRender="BillPgMsg,BillsWholePanel" rendered="{!AND(NOT(apcBPTab.Bread_Winner__Is_PO_Contact_Sync_Completed__c) , apcBPTab.Bread_Winner__Sync_POs__c, isBusinessOrHigher)}" oncomplete="HideStyleSheet();message();" / -->
                                                        <apex:commandLink value="Save" action="{!saveBPConfigs}" status="assign-action-status" styleClass="slds-button slds-button--brand" reRender="PosWholePanel,PoPgMsg"  oncomplete="HideStyleSheet();message();scrolltoTop();" rendered="{!AND(OR(AND(isMultiOrgEnabled,SelectedOrg!=null,apcBPTab.Bread_Winner__Sync_POs__c),AND(isMultiOrgEnabled,SelectedOrg==null),NOT(isMultiOrgEnabled)))}" />
                                                    </div>
                                                </apex:outputPanel>
                                                <apex:pagemessage severity="Info" summary="Please Enable POs! " rendered="{!AND(isPosEnabled==false,SelectedOrg==null,isMultiOrgEnabled)}" ></apex:pagemessage>
                                            </apex:outputPanel>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                        
                                        <apex:actionFunction name="POsOnOffFunctionapexBPTab"  action="{!allowBillsPOsSync}" status="assign-action-status" rerender="PosWholePanel,SynView,MutliOrgAccountSyncView,accountSyncPanel,DefaultPOAccCodes,DefaultPOAccCodes1,PoPgMsg"  oncomplete="HideStyleSheet();message();RerenderAccountCodes();">           
                                            <apex:param id="PosValue" name="AllowPOssync" value="" />
                                        </apex:actionFunction>
                                        <apex:actionFunction name="RerenderAccountCodes1"  rerender="POsAccountCodes, DefaultPOAccCodes" oncomplete="HideStyleSheet();message();">             
                                        </apex:actionFunction>
                                        <script>
                                        function RerenderAccountCodes(){
                                            window.setTimeout(RerenderAccountCodes1,10000)
                                        }                
                                        </script>
                                    </div>
                                    
                                    <div id="Learn-TAB1" class="slds-hide" aria-labelledby="KnowledgeBase">
                                        <!-- -----------------------------KnowledgeBase Tab header start ---------------------------->
                                        <div class="slds-page-header" role="banner">
                                            <div class="slds-media">
                                                <div class="slds-media__figure">
                                                    <span class="slds-icon_container slds-icon_container--circle slds-icon-action-description" title="Knowledge Base">
                                                        <svg aria-hidden="true" class="slds-icon slds-icon--small">
                                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/action-sprite/svg/symbols.svg#google_news')}"></use>
                                                        </svg>
                                                    </span>
                                                </div>
                                                <div class="slds-media__body">
                                                    <p class="slds-page-header__title slds-truncate" title="Knowledge Base">Knowledge Base</p>
                                                    <p class="slds-text-body--small">Breadwinner â€¢ Xero </p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- -----------------------------KnowledgeBase Tab header END ---------------------------->
                                        <!-- <apex:iframe src="{!BW_SupportPortalURL}/?t=711658" height="700px" scrolling="true"/>                              -->
                                        <div id="Knowledge_BasePage"></div>
                                    </div>
                                    <div id="Learn-TAB2" class="slds-hide" aria-labelledby="ContactSupport">
                                        <!-- -----------------------------ContactSupport Tab header start ---------------------------->
                                        <div class="slds-page-header" role="banner">
                                            <div class="slds-media">
                                                <div class="slds-media__figure">
                                                    <span class="slds-icon_container slds-icon_container--circle slds-icon-action-description" title="Contact Support">
                                                        <svg aria-hidden="true" class="slds-icon slds-icon--small">
                                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/action-sprite/svg/symbols.svg#email')}"></use>
                                                        </svg>
                                                    </span>
                                                </div>
                                                <div class="slds-media__body">
                                                    <p class="slds-page-header__title slds-truncate" title="Contact Support">Contact Support</p>
                                                    <p class="slds-text-body--small">Breadwinner â€¢ Xero </p>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- -----------------------------ContactSupport Tab header END ---------------------------->
                                        <!-- <apex:iframe src="{!BW_SupportPortalURL}/customer/portal/emails/new?t=711718" height="700px" scrolling="true"/> -->
                                        <div id="Contact_SupportPage"></div>
                                    </div>
                                    
                                    <div id="ADMIN-1" class="slds-hide" role="tabpanel" aria-labelledby="Billing">
                                        <div class="slds-page-header slds-m-bottom--medium" role="banner">
                                            <div class="slds-media">
                                                <div class="slds-media__figure">
                                                    <span class="slds-icon_container slds-icon_container--circle slds-icon-action-description" title="Billing">
                                                        <svg aria-hidden="true" class="slds-icon slds-icon--small">
                                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/action-sprite/svg/symbols.svg#google_news')}"></use>
                                                        </svg>
                                                    </span>
                                                </div>
                                                <div class="slds-media__body">
                                                    <p class="slds-page-header__title slds-truncate" title="Billing">Billing</p>
                                                    <p class="slds-text-body--small">Breadwinner â€¢ Xero </p>
                                                </div>
                                            </div>
                                        </div>   
                                        <apex:outputPanel rendered="{!IF(orgStatus =='expired', true, false)}" layout="block" styleClass="slds-m-horizontal--small slds-text-longform" style="color: #5876a3;">Your Data Subscription to Breadwinner has Expired. Please contact sales@breadwinner.com</apex:outputPanel>
                                        <apex:outputPanel rendered="{!IF(orgStatus =='expired', false, true)}">
                                        <div Class="slds-m-horizontal--small" style="font-size: 14px;color: #5876a3;" >
                                            
                                            <apex:outputPanel layout="block" styleClass="slds-text-longform" rendered="{!NOT(isDisplayHostedLoginToken)}" >
                                                This tab is used to update your credit card information, and will be active once you subscribe.
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="block" rendered="{!isDisplayHostedLoginToken}" >
                                            <apex:outputPanel layout="block" styleClass="slds-m-top--medium" rendered="{!AND(isAdministrator,contains(hostedLoginToken,'/'))}">
                                                <p>
                                                    You can update your billing details, download invoices, or cancel your account at any time by &nbsp;
                                                <a href="https://www.billingportal.com/manage/{!hostedLoginToken}" target="_blank"  >clicking here</a>
                                                </p>
                                                <p>
                                                    If you'd like to stop using Breadwinner, please note that <b>you must first cancel your account through the link above, and only after that uninstall.</b>
                                                </p>
                                                
                                                <div class="slds-text-longform slds-m-top--medium">
                                                    <p>
                                                        Breadwinner is charged based on your monthly Invoice Volume, averaged over the last 3 months. 
                                                        We count Invoices created with Breadwinner, and Invoices created directly in your accounting system. 
                                                        We ignore Draft, Voided, and Deleted invoices.
                                                    </p>
                                                    <p>
                                                        We calculate the number of Invoices with an Invoice Date in the last 90 days, and divide by 3, to determine your average monthly volume.
                                                        Taking your average invoice count is beneficial to you the customer, as seasonal spikes or a particularly busy month are smoothed out.
                                                        If you consistently go over your limit, we will continue syncing your invoices, however we will contact you to begin the process of upgrading you to the next level.
                                                    </p>
                                                    <p>
                                                        You have {!invoiceCountForLast90Days} invoices with an Invoice status of Authorized or Paid,
                                                        with an Invoice Date in the last 90 days, which averages to {!averageInvoiceCount} Invoices per month.
                                                        <br/><apex:outputLink value="{!$Page.Bread_Winner__InvoiceMapping}" style="color:blue;"> Click here</apex:outputLink> for a detailed report of how this number is calculated

                                                    </p>
                                                    
                                                </div>
                                                
                                            </apex:outputPanel>
                                            
                                            <apex:outputPanel layout="block" styleClass="slds-text-body--small" rendered="{!AND(isAdministrator,NOT(contains(hostedLoginToken,'/')))}" >
                                                
                                                <p>
                                                    Breadwinner is using a new billing engine. Your Credit Card details are in our old billing engine.
                                                </p>
                                                <p>
                                                   Over the next few months, we will be gradually moving people onto the new billing engine, which may require you to re-enter your Credit Card details. 
                                                </p>
                                                <p>
                                                    If you wish to manually update, or cancel, your Credit Card details, please go to Contact Support section on the left and file a support case.
                                                </p>
                                                
                                            </apex:outputPanel>
                                            
                                            <apex:outputPanel layout="block" styleClass="slds-text-body--small slds-m-top--small" rendered="{!NOT(isAdministrator)}">
                                                You must be a Salesforce System Administrator to access billing information.            
                                            </apex:outputPanel>
                                            </apex:outputPanel>
                                        </div >
                                        </apex:outputPanel>
                                    </div>
                                    <div id="ADMIN-21" class="slds-hide" role="tabpanel" aria-labelledby="Troubleshooting">
                                        
                                        <!-- <apex:variable value="TroubleshootingPage" var="TroubleshootingPageURL"/>
                                        <apex:iframe src="{!TroubleshootingPageURL}" frameborder="false" scrolling="true" height="700px"/> -->
                                        
                                    </div>
                                    <div id="ADMIN-22" class="slds-hide" role="tabpanel" aria-labelledby="StatusLogs">
                                        
                                        <div class="slds-page-header slds-m-bottom--medium" role="banner">
                                            <div class="slds-media">
                                                <div class="slds-media__figure">
                                                    <svg aria-hidden="true" class="slds-icon slds-icon-standard-opportunity">
                                                        <use xlink:href="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/SLDS/assets/icons/standard-sprite/svg/symbols.svg#custom')}"></use>
                                                    </svg>
                                                </div>
                                                <div class="slds-media__body">
                                                    <p class="slds-page-header__title slds-truncate" title="Status Logs">Status Logs</p>
                                                    <p class="slds-text-body--small">Breadwinner â€¢ Xero </p>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="slds-m-horizontal--small">
                                        <div style="color: #54698d;" >
                                             This page shows error messages and exceptions. To check logs please click on the button below.
                                        </div>
                                        <apex:commandButton styleClass="slds-m-top--medium slds-button slds-button--brand" value="Check Log for Recent Errors" onclick="drawTable();" reRender="nothingRenders" />
                                        
                                        <div id="StatusLogSpinner" style="display:none;">
                                            <div class="slds-spinner_container">
                                                <div class="slds-spinner--brand slds-spinner slds-spinner--medium" role="alert">
                                                    <span class="slds-assistive-text">Loading</span>
                                                    <div class="slds-spinner__dot-a"></div>
                                                    <div class="slds-spinner__dot-b"></div>
                                                </div>
                                            </div>
                                        </div>                                        
                                        
                                        <div  class="slds-m-top--medium" id="table_div"></div>
                                        <div id="message" class="slds-m-top--medium" ></div>
                                    </div>
                                      
                                    </div>
                                    <div id="ADMIN-23" class="slds-hide" role="tabpanel" aria-labelledby="BatchInvoice">
                                        <apex:outputPanel layout="block" id="BatchInvoiceSection">
                                            <!-- <apex:variable value="OpportunityBatchInvoicePage" var="BatchInvoicePageURL"/>
                                            <apex:iframe src="{!BatchInvoicePageURL}" frameborder="false" scrolling="true" height="700px"/> -->
                                        </apex:outputPanel>
                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel layout="block" styleClass="slds-align--absolute-center" rendered="{!NOT(isBreadwinnerConnection)}">
                        
                        <div >
                            
                            
                            <div class="slds-page-header slds-m-bottom--large" role="banner">
                                <div class="slds-media">
                                    <div class="slds-media__figure">
                                        <img src="{!URLFOR($Resource.Breadwinner_Xero, 'Breadwinner_Xero/Images/BreadwinnerLogo.png')}" alt="Breadwinner Logo" />
                                    </div>
                                    <div class="slds-media__body">
                                        <ul class="slds-list--dotted">
                                            <li class="slds-text-heading--small" >You have selected to connect to Xero using: {!connectionTypeSelected}</li>
                                            <li class="slds-text-heading--small slds-m-top--x-small" >All Apex, Visualforce, Lightning Components, and everything else contained in this app are fully functional</li>
                                            <li class="slds-text-heading--small slds-m-top--x-small" >As this is a free app, no support is provided.</li>
                                            <li class="slds-text-heading--small slds-m-top--x-small" >To change how you connect to Xero, please&nbsp;<apex:commandLink value="change your Connection Settings" action="{!showPopup}" reRender="tstpopup"/>.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel id="tstpopup">
                        <apex:outputPanel styleClass="popupBackground" layout="block" rendered="{!displayPopUp}">
                            
                            <div role="alertdialog" tabindex="-1" aria-labelledby="prompt-heading-id" aria-describedby="prompt-message-wrapper" class="slds-modal slds-fade-in-open slds-modal--prompt">
                                <div class="slds-modal__container">
                                    <div class="slds-modal__header slds-theme--info slds-theme--alert-texture">        
                                        <h2 class="slds-text-heading--medium" id="prompt-heading-id">Connection Settings</h2>
                                    </div>
                                    <div class="slds-modal__content slds-p-around--medium">
                                        <div>
                                            <p>Please select how you would like to connect to Xero. Please note that some of these options may require payment to a third party data service.</p>
                                            <div class="slds-m-top--medium">
                                                
                                                <apex:inputHidden value="{!bwSetting.Bread_Winner__Connection_Type__c}" id="ConnectionTypeValue"/>
                                                
                                                <fieldset class="slds-form-element">
                                                    <legend class="slds-form-element__legend slds-form-element__label">Data Services</legend>
                                                    
                                                    <apex:repeat value="{!ConnectionTypeKeys}" var="ConxnKey" >
                                                        <div class="slds-form-element__control">
                                                            <label class="slds-radio">
                                                                <input type="radio" id="{!ConxnKey}" name="Dataoptions" onclick="SelectedService('{!ConxnKey}');" />
                                                                <span class="slds-radio--faux"></span>
                                                                <span class="slds-form-element__label">{!ConnectionTypeMap[ConxnKey]}</span>
                                                            </label>
                                                        </div>
                                                    </apex:repeat>
                                                </fieldset>
                                                <script>
                                                document.getElementById('{!JSENCODE(bwSetting.Connection_Type__c)}').checked = true;
                                                </script>                                                        
                                                <script>
                                                function SelectedService(inputvalue) {
                                                    document.getElementById('{!JSENCODE($Component.theForm.ConnectionTypeValue)}').value = inputvalue;
                                                }
                                                </script>
                                                
                                            </div>
                                            
                                            
                                        </div>
                                    </div>
                                    <div class="slds-modal__footer slds-theme--default">
                                        <apex:commandButton action="{!saveBWSetting}" styleClass="slds-button slds-button--brand" status="assign-action-status" value="Save"/>&nbsp;&nbsp;
                                        <apex:commandButton value="Cancel" styleClass="slds-button slds-button--neutral" status="assign-action-status" action="{!closePopup}" rerender="tstpopup"/>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-backdrop slds-backdrop--open"></div> 
                        </apex:outputPanel>
                    </apex:outputPanel>
                </div>
                
                
                <apex:actionFunction status="assign-action-status" name="checkSetupTabStepsCompletedFunc" action="{!initializeApp}" id="checkSetupTabStepsCompletedId"   reRender="SynView, MutliOrgAccountSyncView, accountSyncPanel, SyncViewImg, InactiveUserMessage" oncomplete="HideStyleSheet();message();"/> 
                
                <!-- <apex:actionFunction name="checkIfLayoutIsUpdated" action="{!checkIfPagelayoutsAreUpdated}" status="assign-action-status" oncomplete="checkIfOpportunityPagelayoutsAreUpdated();HideStyleSheet();message();"/> -->
                <apex:actionFunction name="checkIfOpportunityPagelayoutsAreUpdated" action="{!checkIfOpportunityPagelayoutsAreUpdated}" status="assign-action-status"  reRender="progressPanel,infoPanel,pagelayoutCheck,V2Section,pageLayoutUpdatePanel,pageLayoutHeadingPanel,OnOfftoggles,V2Pagelayouts" oncomplete="HideStyleSheet();message();"/>
                <apex:actionFunction name="deleteAppConfig" action="{!deleteAppConfig}" immediate="true" oncomplete="HideStyleSheet();message();"/>
            </apex:form>
            <apex:outputPanel id="scriptPanel">   
                
                <script>
                function displayMessageOnSave(){ 
                    
                    alert('You must install new version of Breadwinner from Appexchange, in order to let Breadwinner work for you.');                  
                } 
                </script>
            </apex:outputPanel> 
            
            <apex:outputPanel id="RestartHistoricalSyncScriptPanel">
                <script>
                function onCompletionOfRestartHistoricalSync()
                {
                    if({!isRestartHistoricalSyncSuccessful} == true)
                        alert('Historical Sync was successfully restarted');
                    else
                        alert('Error');                
                }
                </script>
            </apex:outputPanel>
            
            <script>
            function onTabEnterPushToInteractionLog(tabName)
            {
                Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.BreadwinnerController.pushInteractionLogOnTabEnter}', 
                                                          tabName, 
                                                          function(result, event){
                                                              if (event.status) 
                                                              {                           
                                                              } 
                                                              else if (event.type === 'exception') 
                                                              {                           
                                                              } 
                                                                  else 
                                                                  {                           
                                                                  }
                                                          }, 
                                                          {escape: true}
                                                         );    
            }                
            </script>
            
            <script type="text/javascript">
            function confirmRefreshing(){
                var c = confirm("This will manually refresh Xero Accounting Information, such as Invoice Branding Themes, Revenue Accounts, Tax Rates, and Tracking Codes. \n\nBreadwinner refreshes these every night automatically, so refreshing manually is not necessary unless you need them refreshed right now.\n\nPlease note that if you were in the middle of creating an Invoice, you will have to start over again for that invoice to see the updated values.\n\nClick OK to refresh them.");
                if(c){
                    return true;
                }
                else{
                    return false;
                }
            }
            
            function ReconnectToXero(){
                var conf = confirm("To reconnect Breadwinner, you must be a Xero Admin. Only click OK if you are also a Xero Admin, otherwise please click Cancel.\n\nYou will be directed to Xero where you will authorize Breadwinner. After authorizing, you will return to the Breadwinner tab in Salesforce. Please look for the tab 'Configuration' below the Setup tab. This is where you can configure additional settings such as your default due date on Invoices created through Breadwinner.");
                if(conf){
                    return true;
                }
                else{
                    return false;
                }
            }
            
            
            </script>
            
            <script type="text/javascript">
            function createRemoteSiteMetadata(){
                try{
                    var binding = new XMLHttpRequest();
                    var host = "{!LEFT($Api.Enterprise_Server_URL_330, FIND('/services',$Api.Enterprise_Server_URL_330))}";
                    var request = 
                        '<?xml version="1.0" encoding="UTF-8"?><env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><env:Header><SessionHeader xmlns="http://soap.sforce.com/2006/04/metadata"><sessionId>{!$Api.Session_ID}</sessionId></SessionHeader></env:Header><env:Body><upsertMetadata xmlns="http://soap.sforce.com/2006/04/metadata"><metadata xsi:type="RemoteSiteSetting"><fullName>Breadwinner_Xero_MyServer</fullName><description>Required to use Metadata API, created by Breadwinner</description><disableProtocolSecurity>false</disableProtocolSecurity><isActive>true</isActive><url>'+host+'</url></metadata></upsertMetadata></env:Body></env:Envelope>';
                    
                    binding.open('POST', host+'services/Soap/m/33.0');
                    binding.setRequestHeader('SOAPAction','""');
                    binding.setRequestHeader('Content-Type', 'text/xml');
                    binding.onreadystatechange =
                        function() {
                        if(this.readyState==4) {
                            var parser = new DOMParser();
                            var doc  = parser.parseFromString(this.response, 'application/xml');
                            var errors = doc.getElementsByTagName('errors');
                            console.log(errors);
                        }
                    }
                    binding.send(request);
                }
                catch(error){
                    console.log(error);
                }
            }
            
            </script>
            <apex:outputPanel id="chartPanel">
                <script type="text/javascript">
                
                google.load("visualization", "1", {packages:["table"]});
                
                function drawTable() {
                    
                    document.getElementById("StatusLogSpinner").style.display = "" ;
                    
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.BreadwinnerController.gettableChartData}', 
                        function(result, event){
                            if (event.status) {
                                if(result.length > 0){
                                    var dataAsArray = new Array();
                                    var columnArray = ["Log Id", "Event Type", "Event Detail", "Additional Detail", "Time"];
                                    dataAsArray.push(columnArray);
                                    
                                    for (var i=0; i<result.length; i++) {
                                        var obj =result[i];
                                        var rowArray = [obj.log_id, obj.event_type, obj.event_detail, obj.additional_detail, obj.timestamp];
                                        dataAsArray.push(rowArray );
                                    }
                                    
                                    var data = google.visualization.arrayToDataTable(dataAsArray);
                                    
                                    
                                    var table = new google.visualization.Table(document.getElementById('table_div'));
                                    
                                    table.draw(data, {showRowNumber: false});
                                }
                                else{
                                    document.getElementById("message").innerHTML = "Congratulations! There are no error logs.";
                                    document.getElementById("table_div").style.display = "none" ;                        
                                }
                                document.getElementById("StatusLogSpinner").style.display = "none" ;
                            }
                        }
                    );
                }
                
                
                </script>
                <script>
                function Check_PageLayoutsStatus(cb){
                    document.getElementById('PageLayoutsStatus').checked = cb.checked; 
                    SaveUpdatePagelayouts(cb.checked);
                }
                function Check_PageLayoutsStatus1(cb){      
                    document.getElementById('PageLayoutsStatus1').checked = cb.checked;        
                    SaveUpdatePagelayouts1(cb.checked);        
                }
                
                </script>
            </apex:outputPanel>
           
        </body>
    </html>
</apex:page>